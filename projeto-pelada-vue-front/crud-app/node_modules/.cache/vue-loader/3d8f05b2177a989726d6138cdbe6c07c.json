{"remainingRequest":"C:\\Users\\kraic\\eclipse-workspace\\projeto-pelada-vue\\projeto-pelada-vue-front\\crud-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\kraic\\eclipse-workspace\\projeto-pelada-vue\\projeto-pelada-vue-front\\crud-app\\node_modules\\primevue\\datatable\\DataTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\kraic\\eclipse-workspace\\projeto-pelada-vue\\projeto-pelada-vue-front\\crud-app\\node_modules\\primevue\\datatable\\DataTable.vue","mtime":499162500000},{"path":"C:\\Users\\kraic\\eclipse-workspace\\projeto-pelada-vue\\projeto-pelada-vue-front\\crud-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\kraic\\eclipse-workspace\\projeto-pelada-vue\\projeto-pelada-vue-front\\crud-app\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\kraic\\eclipse-workspace\\projeto-pelada-vue\\projeto-pelada-vue-front\\crud-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\kraic\\eclipse-workspace\\projeto-pelada-vue\\projeto-pelada-vue-front\\crud-app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBPYmplY3RVdGlscyBmcm9tICcuLi91dGlscy9PYmplY3RVdGlscyc7CmltcG9ydCBGaWx0ZXJVdGlscyBmcm9tICcuLi91dGlscy9GaWx0ZXJVdGlscyc7CmltcG9ydCBEb21IYW5kbGVyIGZyb20gJy4uL3V0aWxzL0RvbUhhbmRsZXInOwppbXBvcnQgUGFnaW5hdG9yIGZyb20gJy4uL3BhZ2luYXRvci9QYWdpbmF0b3InOwppbXBvcnQgU2Nyb2xsYWJsZVZpZXcgZnJvbSAnLi9TY3JvbGxhYmxlVmlldy52dWUnOwppbXBvcnQgVGFibGVIZWFkZXIgZnJvbSAnLi9UYWJsZUhlYWRlci52dWUnOwppbXBvcnQgVGFibGVCb2R5IGZyb20gJy4vVGFibGVCb2R5LnZ1ZSc7CmltcG9ydCBUYWJsZUZvb3RlciBmcm9tICcuL1RhYmxlRm9vdGVyLnZ1ZSc7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBwcm9wczogewogICAgICAgIHZhbHVlOiB7CiAgICAgICAgICAgIHR5cGU6IEFycmF5LAogICAgICAgICAgICBkZWZhdWx0OiBudWxsCiAgICAgICAgfSwKICAgICAgICBkYXRhS2V5OiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgIH0sCiAgICAgICAgcm93czogewogICAgICAgICAgICB0eXBlOiBOdW1iZXIsCiAgICAgICAgICAgIGRlZmF1bHQ6IDAKICAgICAgICB9LAogICAgICAgIGZpcnN0OiB7CiAgICAgICAgICAgIHR5cGU6IE51bWJlciwKICAgICAgICAgICAgZGVmYXVsdDogMAogICAgICAgIH0sCiAgICAgICAgdG90YWxSZWNvcmRzOiB7CiAgICAgICAgICAgIHR5cGU6IE51bWJlciwKICAgICAgICAgICAgZGVmYXVsdDogMAogICAgICAgIH0sCiAgICAgICAgcGFnaW5hdG9yOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgfSwKICAgICAgICBwYWdpbmF0b3JQb3NpdGlvbjogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICdib3R0b20nCiAgICAgICAgfSwKICAgICAgICBhbHdheXNTaG93UGFnaW5hdG9yOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUKICAgICAgICB9LAogICAgICAgIHBhZ2luYXRvclRlbXBsYXRlOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ0ZpcnN0UGFnZUxpbmsgUHJldlBhZ2VMaW5rIFBhZ2VMaW5rcyBOZXh0UGFnZUxpbmsgTGFzdFBhZ2VMaW5rIFJvd3NQZXJQYWdlRHJvcGRvd24nCiAgICAgICAgfSwKICAgICAgICBwYWdlTGlua1NpemU6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICBkZWZhdWx0OiA1CiAgICAgICAgfSwKICAgICAgICByb3dzUGVyUGFnZU9wdGlvbnM6IHsKICAgICAgICAgICAgdHlwZTogQXJyYXksCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIGN1cnJlbnRQYWdlUmVwb3J0VGVtcGxhdGU6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0OiAnKHtjdXJyZW50UGFnZX0gb2Yge3RvdGFsUGFnZXN9KScKICAgICAgICB9LAogICAgICAgIGxhenk6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICB9LAogICAgICAgIGxvYWRpbmc6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICB9LAogICAgICAgIGxvYWRpbmdJY29uOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ3BpIHBpLXNwaW5uZXInCiAgICAgICAgfSwKICAgICAgICBzb3J0RmllbGQ6IHsKICAgICAgICAgICAgdHlwZTogW1N0cmluZywgRnVuY3Rpb25dLAogICAgICAgICAgICBkZWZhdWx0OiBudWxsCiAgICAgICAgfSwKICAgICAgICBzb3J0T3JkZXI6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICBkZWZhdWx0OiBudWxsCiAgICAgICAgfSwKICAgICAgICBkZWZhdWx0U29ydE9yZGVyOiB7CiAgICAgICAgICAgIHR5cGU6IE51bWJlciwKICAgICAgICAgICAgZGVmYXVsdDogMQogICAgICAgIH0sCiAgICAgICAgbXVsdGlTb3J0TWV0YTogewogICAgICAgICAgICB0eXBlOiBBcnJheSwKICAgICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgIH0sCiAgICAgICAgc29ydE1vZGU6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0OiAnc2luZ2xlJwogICAgICAgIH0sCiAgICAgICAgcmVtb3ZhYmxlU29ydDogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgZmlsdGVyczogewogICAgICAgICAgICB0eXBlOiBPYmplY3QsCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIGZpbHRlckxvY2FsZTogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6IHVuZGVmaW5lZAogICAgICAgIH0sCiAgICAgICAgc2VsZWN0aW9uOiB7CiAgICAgICAgICAgIHR5cGU6IFtBcnJheSxPYmplY3RdLAogICAgICAgICAgICBkZWZhdWx0OiBudWxsCiAgICAgICAgfSwKICAgICAgICBzZWxlY3Rpb25Nb2RlOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgIH0sCiAgICAgICAgY29tcGFyZVNlbGVjdGlvbkJ5OiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ2RlZXBFcXVhbHMnCiAgICAgICAgfSwKICAgICAgICBtZXRhS2V5U2VsZWN0aW9uOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUKICAgICAgICB9LAogICAgICAgIGNvbnRleHRNZW51OiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgfSwKICAgICAgICBjb250ZXh0TWVudVNlbGVjdGlvbjogewogICAgICAgICAgICB0eXBlOiBPYmplY3QsCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIHJvd0hvdmVyOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgfSwKICAgICAgICBjc3ZTZXBhcmF0b3I6IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0OiAnLCcKICAgICAgICB9LAogICAgICAgIGV4cG9ydEZpbGVuYW1lOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ2Rvd25sb2FkJwogICAgICAgIH0sCiAgICAgICAgYXV0b0xheW91dDogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgcmVzaXphYmxlQ29sdW1uczogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIH0sCiAgICAgICAgY29sdW1uUmVzaXplTW9kZTogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6ICdmaXQnCiAgICAgICAgfSwKICAgICAgICByZW9yZGVyYWJsZUNvbHVtbnM6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICB9LAogICAgICAgIGV4cGFuZGVkUm93czogewogICAgICAgICAgICB0eXBlOiBBcnJheSwKICAgICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgIH0sCiAgICAgICAgZXhwYW5kZWRSb3dJY29uOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ3BpLWNoZXZyb24tZG93bicKICAgICAgICB9LAogICAgICAgIGNvbGxhcHNlZFJvd0ljb246IHsKICAgICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgICBkZWZhdWx0OiAncGktY2hldnJvbi1yaWdodCcKICAgICAgICB9LAogICAgICAgIHJvd0dyb3VwTW9kZTogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIGdyb3VwUm93c0J5OiB7CiAgICAgICAgICAgIHR5cGU6IFtBcnJheSxTdHJpbmddLAogICAgICAgICAgICBkZWZhdWx0OiBudWxsCiAgICAgICAgfSwKICAgICAgICBleHBhbmRhYmxlUm93R3JvdXBzOiB7CiAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgfSwKICAgICAgICBleHBhbmRlZFJvd0dyb3VwczogewogICAgICAgICAgICB0eXBlOiBBcnJheSwKICAgICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgIH0sCiAgICAgICAgc3RhdGVTdG9yYWdlOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogJ3Nlc3Npb24nCiAgICAgICAgfSwKICAgICAgICBzdGF0ZUtleTogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIGVkaXRNb2RlOiB7CiAgICAgICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgIH0sCiAgICAgICAgZWRpdGluZ1Jvd3M6IHsKICAgICAgICAgICAgdHlwZTogQXJyYXksCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIHJvd0NsYXNzOiB7CiAgICAgICAgICAgIHR5cGU6IG51bGwsCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIHNjcm9sbGFibGU6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICB9LAogICAgICAgIHNjcm9sbEhlaWdodDogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIGZyb3plblZhbHVlOiB7CiAgICAgICAgICAgIHR5cGU6IEFycmF5LAogICAgICAgICAgICBkZWZhdWx0OiBudWxsCiAgICAgICAgfSwKICAgICAgICBmcm96ZW5XaWR0aDogewogICAgICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwKICAgICAgICB9LAogICAgICAgIHZpcnR1YWxTY3JvbGw6IHsKICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICB9LAogICAgICAgIHZpcnR1YWxSb3dIZWlnaHQ6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICBkZWZhdWx0OiAyOAogICAgICAgIH0sCiAgICAgICAgdmlydHVhbFNjcm9sbERlbGF5OiB7CiAgICAgICAgICAgIHR5cGU6IE51bWJlciwKICAgICAgICAgICAgZGVmYXVsdDogMTUwCiAgICAgICAgfQogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgYWxsQ2hpbGRyZW46IG51bGwsCiAgICAgICAgICAgIGRfZmlyc3Q6IHRoaXMuZmlyc3QsCiAgICAgICAgICAgIGRfcm93czogdGhpcy5yb3dzLAogICAgICAgICAgICBkX3NvcnRGaWVsZDogdGhpcy5zb3J0RmllbGQsCiAgICAgICAgICAgIGRfc29ydE9yZGVyOiB0aGlzLnNvcnRPcmRlciwKICAgICAgICAgICAgZF9tdWx0aVNvcnRNZXRhOiB0aGlzLm11bHRpU29ydE1ldGEgPyBbLi4udGhpcy5tdWx0aVNvcnRNZXRhXSA6IFtdLAogICAgICAgICAgICBkX3NlbGVjdGlvbktleXM6IG51bGwsCiAgICAgICAgICAgIGRfZXhwYW5kZWRSb3dLZXlzOiBudWxsLAogICAgICAgICAgICBkX2NvbHVtbk9yZGVyOiBudWxsLAogICAgICAgICAgICBkX2VkaXRpbmdSb3dLZXlzOiBudWxsCiAgICAgICAgfTsKICAgIH0sCiAgICByb3dUb3VjaGVkOiBmYWxzZSwKICAgIGFuY2hvclJvd0luZGV4OiBudWxsLAogICAgcmFuZ2VSb3dJbmRleDogbnVsbCwKICAgIGRvY3VtZW50Q29sdW1uUmVzaXplTGlzdGVuZXI6IG51bGwsCiAgICBkb2N1bWVudENvbHVtblJlc2l6ZUVuZExpc3RlbmVyOiBudWxsLAogICAgbGFzdFJlc2l6ZUhlbHBlclg6IG51bGwsCiAgICByZXNpemVDb2x1bW5FbGVtZW50OiBudWxsLAogICAgY29sdW1uUmVzaXppbmc6IGZhbHNlLAogICAgY29sUmVvcmRlckljb25XaWR0aDogbnVsbCwKICAgIGNvbFJlb3JkZXJJY29uSGVpZ2h0OiBudWxsLAogICAgZHJhZ2dlZENvbHVtbjogbnVsbCwKICAgIGRyYWdnZWRSb3dJbmRleDogbnVsbCwKICAgIGRyb3BwZWRSb3dJbmRleDogbnVsbCwKICAgIHJvd0RyYWdnaW5nOiBudWxsLAogICAgY29sdW1uV2lkdGhzU3RhdGU6IG51bGwsCiAgICB0YWJsZVdpZHRoU3RhdGU6IG51bGwsCiAgICBjb2x1bW5XaWR0aHNSZXN0b3JlZDogZmFsc2UsCiAgICB2aXJ0dWFsU2Nyb2xsVGltZXI6IG51bGwsCiAgICB3YXRjaDogewogICAgICAgIGZpcnN0KG5ld1ZhbHVlKSB7CiAgICAgICAgICAgIHRoaXMuZF9maXJzdCA9IG5ld1ZhbHVlOwogICAgICAgIH0sCiAgICAgICAgcm93cyhuZXdWYWx1ZSkgewogICAgICAgICAgICB0aGlzLmRfcm93cyA9IG5ld1ZhbHVlOwogICAgICAgIH0sCiAgICAgICAgc29ydEZpZWxkKG5ld1ZhbHVlKSB7CiAgICAgICAgICAgIHRoaXMuZF9zb3J0RmllbGQgPSBuZXdWYWx1ZTsKICAgICAgICB9LAogICAgICAgIHNvcnRPcmRlcihuZXdWYWx1ZSkgewogICAgICAgICAgICB0aGlzLmRfc29ydE9yZGVyID0gbmV3VmFsdWU7CiAgICAgICAgfSwKICAgICAgICBtdWx0aVNvcnRNZXRhKG5ld1ZhbHVlKSB7CiAgICAgICAgICAgIHRoaXMuZF9tdWx0aVNvcnRNZXRhID0gbmV3VmFsdWU7CiAgICAgICAgfSwKICAgICAgICBzZWxlY3Rpb24obmV3VmFsdWUpIHsKICAgICAgICAgICAgaWYgKHRoaXMuZGF0YUtleSkgewogICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3Rpb25LZXlzKG5ld1ZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZXhwYW5kZWRSb3dzKG5ld1ZhbHVlKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmRhdGFLZXkpIHsKICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXhwYW5kZWRSb3dLZXlzKG5ld1ZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZWRpdGluZ1Jvd3MobmV3VmFsdWUpIHsKICAgICAgICAgICAgaWYgKHRoaXMuZGF0YUtleSkgewogICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFZGl0aW5nUm93S2V5cyhuZXdWYWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgYmVmb3JlTW91bnQoKSB7CiAgICAgICAgaWYgKHRoaXMuaXNTdGF0ZWZ1bCgpKSB7CiAgICAgICAgICAgIHRoaXMucmVzdG9yZVN0YXRlKCk7CiAgICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5hbGxDaGlsZHJlbiA9IHRoaXMuJGNoaWxkcmVuOwoKICAgICAgICBpZiAodGhpcy5yZW9yZGVyYWJsZUNvbHVtbnMpIHsKICAgICAgICAgICAgbGV0IGNvbHVtbk9yZGVyID0gW107CiAgICAgICAgICAgIGZvciAobGV0IGNoaWxkIG9mIHRoaXMuYWxsQ2hpbGRyZW4pIHsKICAgICAgICAgICAgICAgIGlmIChjaGlsZC4kb3B0aW9ucy5fcHJvcEtleXMuaW5kZXhPZignY29sdW1uS2V5JykgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgY29sdW1uT3JkZXIucHVzaChjaGlsZC5jb2x1bW5LZXl8fGNoaWxkLmZpZWxkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmRfY29sdW1uT3JkZXIgPSBjb2x1bW5PcmRlcjsKICAgICAgICB9CiAgICB9LAogICAgYmVmb3JlRGVzdHJveSgpIHsKICAgICAgICB0aGlzLnVuYmluZENvbHVtblJlc2l6ZUV2ZW50cygpOwogICAgfSwKICAgIHVwZGF0ZWQoKSB7CiAgICAgICAgaWYgKHRoaXMuaXNTdGF0ZWZ1bCgpKSB7CiAgICAgICAgICAgIHRoaXMuc2F2ZVN0YXRlKCk7CgogICAgICAgICAgICBpZiAodGhpcy5yZXNpemFibGVDb2x1bW5zICYmICF0aGlzLmNvbHVtbldpZHRoc1Jlc3RvcmVkKSB7CiAgICAgICAgICAgICAgICB0aGlzLnJlc3RvcmVDb2x1bW5XaWR0aHMoKTsKICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uV2lkdGhzUmVzdG9yZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBvblBhZ2UoZXZlbnQpIHsKICAgICAgICAgICAgdGhpcy5kX2ZpcnN0ID0gZXZlbnQuZmlyc3Q7CiAgICAgICAgICAgIHRoaXMuZF9yb3dzID0gZXZlbnQucm93czsKCiAgICAgICAgICAgIGxldCBwYWdlRXZlbnQgPSB0aGlzLmNyZWF0ZUxhenlMb2FkRXZlbnQoZXZlbnQpOwogICAgICAgICAgICBwYWdlRXZlbnQucGFnZUNvdW50ID0gZXZlbnQucGFnZUNvdW50OwogICAgICAgICAgICBwYWdlRXZlbnQucGFnZSA9IGV2ZW50LnBhZ2U7CgogICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6Zmlyc3QnLCB0aGlzLmRfZmlyc3QpOwogICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6cm93cycsIHRoaXMuZF9yb3dzKTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgncGFnZScsIHBhZ2VFdmVudCk7CiAgICAgICAgfSwKICAgICAgICBvbkNvbHVtbkhlYWRlckNsaWNrKGUpIHsKICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBlLm9yaWdpbmFsRXZlbnQ7CiAgICAgICAgICAgIGNvbnN0IGNvbHVtbiA9IGUuY29sdW1uOwoKICAgICAgICAgICAgaWYgKGNvbHVtbi5zb3J0YWJsZSkgewogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Tm9kZSA9IGV2ZW50LnRhcmdldDsKICAgICAgICAgICAgICAgIGNvbnN0IGNvbHVtbkZpZWxkID0gY29sdW1uLnNvcnRGaWVsZCB8fCBjb2x1bW4uZmllbGQ7CgogICAgICAgICAgICAgICAgaWYgKERvbUhhbmRsZXIuaGFzQ2xhc3ModGFyZ2V0Tm9kZSwgJ3Atc29ydGFibGUtY29sdW1uJykgfHwgRG9tSGFuZGxlci5oYXNDbGFzcyh0YXJnZXROb2RlLCAncC1jb2x1bW4tdGl0bGUnKQogICAgICAgICAgICAgICAgICAgIHx8IERvbUhhbmRsZXIuaGFzQ2xhc3ModGFyZ2V0Tm9kZSwgJ3Atc29ydGFibGUtY29sdW1uLWljb24nKSB8fCBEb21IYW5kbGVyLmhhc0NsYXNzKHRhcmdldE5vZGUucGFyZW50RWxlbWVudCwgJ3Atc29ydGFibGUtY29sdW1uLWljb24nKSkgewogICAgICAgICAgICAgICAgICAgIERvbUhhbmRsZXIuY2xlYXJTZWxlY3Rpb24oKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc29ydE1vZGUgPT09ICdzaW5nbGUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRfc29ydEZpZWxkID09PSBjb2x1bW5GaWVsZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVtb3ZhYmxlU29ydCAmJiAodGhpcy5kX3NvcnRPcmRlciAqIC0xID09PSB0aGlzLmRlZmF1bHRTb3J0T3JkZXIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kX3NvcnRPcmRlciA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kX3NvcnRGaWVsZCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRfc29ydE9yZGVyID0gdGhpcy5kX3NvcnRPcmRlciAqIC0xOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kX3NvcnRPcmRlciA9IHRoaXMuZGVmYXVsdFNvcnRPcmRlcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZF9zb3J0RmllbGQgPSBjb2x1bW5GaWVsZDsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNvcnRGaWVsZCcsIHRoaXMuZF9zb3J0RmllbGQpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6c29ydE9yZGVyJywgdGhpcy5kX3NvcnRPcmRlcik7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRQYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc29ydE1vZGUgPT09ICdtdWx0aXBsZScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1ldGFLZXkgPSBldmVudC5tZXRhS2V5IHx8IGV2ZW50LmN0cmxLZXk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWV0YUtleSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kX211bHRpU29ydE1ldGEgPSAgdGhpcy5kX211bHRpU29ydE1ldGEuZmlsdGVyKG1ldGEgPT4gbWV0YS5maWVsZCA9PT0gY29sdW1uRmllbGQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZE11bHRpU29ydEZpZWxkKGNvbHVtbkZpZWxkKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOm11bHRpU29ydE1ldGEnLCB0aGlzLmRfbXVsdGlTb3J0TWV0YSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzb3J0JywgdGhpcy5jcmVhdGVMYXp5TG9hZEV2ZW50KGV2ZW50KSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHNvcnRTaW5nbGUodmFsdWUpIHsKICAgICAgICAgICAgbGV0IGRhdGEgPSBbLi4udmFsdWVdOwoKICAgICAgICAgICAgZGF0YS5zb3J0KChkYXRhMSwgZGF0YTIpID0+IHsKICAgICAgICAgICAgICAgIGxldCB2YWx1ZTEgPSBPYmplY3RVdGlscy5yZXNvbHZlRmllbGREYXRhKGRhdGExLCB0aGlzLmRfc29ydEZpZWxkKTsKICAgICAgICAgICAgICAgIGxldCB2YWx1ZTIgPSBPYmplY3RVdGlscy5yZXNvbHZlRmllbGREYXRhKGRhdGEyLCB0aGlzLmRfc29ydEZpZWxkKTsKCiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gbnVsbDsKCiAgICAgICAgICAgICAgICBpZiAodmFsdWUxID09IG51bGwgJiYgdmFsdWUyICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gLTE7CiAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZTEgIT0gbnVsbCAmJiB2YWx1ZTIgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSAxOwogICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUxID09IG51bGwgJiYgdmFsdWUyID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gMDsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZTEgPT09ICdzdHJpbmcnICYmIHR5cGVvZiB2YWx1ZTIgPT09ICdzdHJpbmcnKQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlMS5sb2NhbGVDb21wYXJlKHZhbHVlMiwgdW5kZWZpbmVkLCB7IG51bWVyaWM6IHRydWUgfSk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gKHZhbHVlMSA8IHZhbHVlMikgPyAtMSA6ICh2YWx1ZTEgPiB2YWx1ZTIpID8gMSA6IDA7CgogICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLmRfc29ydE9yZGVyICogcmVzdWx0KTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gZGF0YTsKICAgICAgICB9LAogICAgICAgIHNvcnRNdWx0aXBsZSh2YWx1ZSkgewogICAgICAgICAgICBsZXQgZGF0YSA9IFsuLi52YWx1ZV07CgogICAgICAgICAgICBkYXRhLnNvcnQoKGRhdGExLCBkYXRhMikgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlzb3J0RmllbGQoZGF0YTEsIGRhdGEyLCAwKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXR1cm4gZGF0YTsKICAgICAgICB9LAogICAgICAgIG11bHRpc29ydEZpZWxkKGRhdGExLCBkYXRhMiwgaW5kZXgpIHsKICAgICAgICAgICAgY29uc3QgdmFsdWUxID0gT2JqZWN0VXRpbHMucmVzb2x2ZUZpZWxkRGF0YShkYXRhMSwgdGhpcy5kX211bHRpU29ydE1ldGFbaW5kZXhdLmZpZWxkKTsKICAgICAgICAgICAgY29uc3QgdmFsdWUyID0gT2JqZWN0VXRpbHMucmVzb2x2ZUZpZWxkRGF0YShkYXRhMiwgdGhpcy5kX211bHRpU29ydE1ldGFbaW5kZXhdLmZpZWxkKTsKICAgICAgICAgICAgbGV0IHJlc3VsdCA9IG51bGw7CgogICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlMSA9PT0gJ3N0cmluZycgfHwgdmFsdWUxIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsdWUxLmxvY2FsZUNvbXBhcmUgJiYgKHZhbHVlMSAhPT0gdmFsdWUyKSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAodGhpcy5kX211bHRpU29ydE1ldGFbaW5kZXhdLm9yZGVyICogdmFsdWUxLmxvY2FsZUNvbXBhcmUodmFsdWUyLCB1bmRlZmluZWQsIHsgbnVtZXJpYzogdHJ1ZSB9KSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICByZXN1bHQgPSAodmFsdWUxIDwgdmFsdWUyKSA/IC0xIDogMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHZhbHVlMSA9PT0gdmFsdWUyKSAgewogICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLmRfbXVsdGlTb3J0TWV0YS5sZW5ndGggLSAxKSA+IChpbmRleCkgPyAodGhpcy5tdWx0aXNvcnRGaWVsZChkYXRhMSwgZGF0YTIsIGluZGV4ICsgMSkpIDogMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuICh0aGlzLmRfbXVsdGlTb3J0TWV0YVtpbmRleF0ub3JkZXIgKiByZXN1bHQpOwogICAgICAgIH0sCiAgICAgICAgYWRkTXVsdGlTb3J0RmllbGQoZmllbGQpIHsKICAgICAgICAgICAgbGV0IGluZGV4ID0gIHRoaXMuZF9tdWx0aVNvcnRNZXRhLmZpbmRJbmRleChtZXRhID0+IG1ldGEuZmllbGQgPT09IGZpZWxkKTsKCiAgICAgICAgICAgIGlmIChpbmRleCA+PSAwKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZW1vdmFibGVTb3J0ICYmICh0aGlzLmRfbXVsdGlTb3J0TWV0YVtpbmRleF0ub3JkZXIgKiAtMSA9PT0gdGhpcy5kZWZhdWx0U29ydE9yZGVyKSkKICAgICAgICAgICAgICAgICAgICB0aGlzLmRfbXVsdGlTb3J0TWV0YS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHRoaXMuZF9tdWx0aVNvcnRNZXRhW2luZGV4XSA9IHtmaWVsZDogZmllbGQsIG9yZGVyOiB0aGlzLmRfbXVsdGlTb3J0TWV0YVtpbmRleF0ub3JkZXIgKiAtMX07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmRfbXVsdGlTb3J0TWV0YS5wdXNoKHtmaWVsZDogZmllbGQsIG9yZGVyOiB0aGlzLmRlZmF1bHRTb3J0T3JkZXJ9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5kX211bHRpU29ydE1ldGEgPSBbLi4udGhpcy5kX211bHRpU29ydE1ldGFdOwogICAgICAgIH0sCiAgICAgICAgZmlsdGVyKGRhdGEpIHsKICAgICAgICAgICAgdGhpcy5kX2ZpcnN0ID0gMDsKICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOmZpcnN0JywgdGhpcy5kX2ZpcnN0KTsKCiAgICAgICAgICAgIGxldCBmaWx0ZXJlZFZhbHVlID0gW107CgogICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgbGV0IGxvY2FsTWF0Y2ggPSB0cnVlOwogICAgICAgICAgICAgICAgbGV0IGdsb2JhbE1hdGNoID0gZmFsc2U7CgogICAgICAgICAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IHRoaXMuY29sdW1ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCBjb2wgPSB0aGlzLmNvbHVtbnNbal07CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbHVtbkZpZWxkID0gY29sLmZpbHRlckZpZWxkIHx8IGNvbC5maWVsZDsKCiAgICAgICAgICAgICAgICAgICAgLy9sb2NhbAogICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5maWx0ZXJzLCBjb2x1bW5GaWVsZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbHRlclZhbHVlID0gdGhpcy5maWx0ZXJzW2NvbHVtbkZpZWxkXTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGFGaWVsZFZhbHVlID0gT2JqZWN0VXRpbHMucmVzb2x2ZUZpZWxkRGF0YShkYXRhW2ldLCBjb2x1bW5GaWVsZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmaWx0ZXJDb25zdHJhaW50ID0gY29sLmZpbHRlck1hdGNoTW9kZSA9PT0gJ2N1c3RvbScgPyBjb2wuZmlsdGVyRnVuY3Rpb24gOiBGaWx0ZXJVdGlsc1tjb2wuZmlsdGVyTWF0Y2hNb2RlXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXJDb25zdHJhaW50KGRhdGFGaWVsZFZhbHVlLCBmaWx0ZXJWYWx1ZSwgdGhpcy5maWx0ZXJMb2NhbGUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbE1hdGNoID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbG9jYWxNYXRjaCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICghY29sLmV4Y2x1ZGVHbG9iYWxGaWx0ZXIgJiYgdGhpcy5oYXNHbG9iYWxGaWx0ZXIoKSAmJiAhZ2xvYmFsTWF0Y2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsTWF0Y2ggPSBGaWx0ZXJVdGlscy5jb250YWlucyhPYmplY3RVdGlscy5yZXNvbHZlRmllbGREYXRhKGRhdGFbaV0sIGNvbHVtbkZpZWxkKSwgdGhpcy5maWx0ZXJzWydnbG9iYWwnXSwgdGhpcy5maWx0ZXJMb2NhbGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsZXQgbWF0Y2hlcyA9IGxvY2FsTWF0Y2g7CiAgICAgICAgICAgICAgICBpZih0aGlzLmhhc0dsb2JhbEZpbHRlcigpKSB7CiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcyA9IGxvY2FsTWF0Y2ggJiYgZ2xvYmFsTWF0Y2g7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYobWF0Y2hlcykgewogICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkVmFsdWUucHVzaChkYXRhW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGZpbHRlcmVkVmFsdWUubGVuZ3RoID09PSBkYXRhLmxlbmd0aCkgewogICAgICAgICAgICAgICAgZmlsdGVyZWRWYWx1ZSA9IGRhdGE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBmaWx0ZXJFdmVudCA9IHRoaXMuY3JlYXRlTGF6eUxvYWRFdmVudCgpOwogICAgICAgICAgICBmaWx0ZXJFdmVudC5maWx0ZXJlZFZhbHVlID0gZmlsdGVyZWRWYWx1ZTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgnZmlsdGVyJywgZmlsdGVyRXZlbnQpOwoKICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkVmFsdWU7CiAgICAgICAgfSwKICAgICAgICBvblJvd0NsaWNrKGUpIHsKICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBlLm9yaWdpbmFsRXZlbnQ7CiAgICAgICAgICAgIGlmIChEb21IYW5kbGVyLmlzQ2xpY2thYmxlKGV2ZW50LnRhcmdldCkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LWNsaWNrJywgZSk7CgogICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2RlKSB7CiAgICAgICAgICAgICAgICBjb25zdCByb3dEYXRhID0gZS5kYXRhOwogICAgICAgICAgICAgICAgY29uc3Qgcm93SW5kZXggPSBlLmluZGV4OwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTXVsdGlwbGVTZWxlY3Rpb25Nb2RlKCkgJiYgZXZlbnQuc2hpZnRLZXkgJiYgdGhpcy5hbmNob3JSb3dJbmRleCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgRG9tSGFuZGxlci5jbGVhclNlbGVjdGlvbigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMucmFuZ2VSb3dJbmRleCA9IHJvd0luZGV4OwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0UmFuZ2UoZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLmlzU2VsZWN0ZWQocm93RGF0YSk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWV0YVNlbGVjdGlvbiA9IHRoaXMucm93VG91Y2hlZCA/IGZhbHNlIDogdGhpcy5tZXRhS2V5U2VsZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYW5jaG9yUm93SW5kZXggPSByb3dJbmRleDsKICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmdlUm93SW5kZXggPSByb3dJbmRleDsKCiAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGFTZWxlY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1ldGFLZXkgPSBldmVudC5tZXRhS2V5IHx8IGV2ZW50LmN0cmxLZXk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQgJiYgbWV0YUtleSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5pc1NpbmdsZVNlbGVjdGlvbk1vZGUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpzZWxlY3Rpb24nLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbkluZGV4ID0gdGhpcy5maW5kSW5kZXhJblNlbGVjdGlvbihyb3dEYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBfc2VsZWN0aW9uID0gdGhpcy5zZWxlY3Rpb24uZmlsdGVyKCh2YWwsaSkgPT4gaSAhPSBzZWxlY3Rpb25JbmRleCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGlvbicsIF9zZWxlY3Rpb24pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3Jvdy11bnNlbGVjdCcsIHtvcmlnaW5hbEV2ZW50OiBldmVudCwgZGF0YTogcm93RGF0YSwgaW5kZXg6IGV2ZW50LmluZGV4LCB0eXBlOiAncm93J30pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5pc1NpbmdsZVNlbGVjdGlvbk1vZGUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpzZWxlY3Rpb24nLCByb3dEYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaXNNdWx0aXBsZVNlbGVjdGlvbk1vZGUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBfc2VsZWN0aW9uID0gbWV0YUtleSA/ICh0aGlzLnNlbGVjdGlvbiB8fCBbXSkgOiBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2VsZWN0aW9uID0gWy4uLl9zZWxlY3Rpb24sIHJvd0RhdGFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpzZWxlY3Rpb24nLCBfc2VsZWN0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdyb3ctc2VsZWN0Jywge29yaWdpbmFsRXZlbnQ6IGV2ZW50LCBkYXRhOiByb3dEYXRhLCBpbmRleDogZXZlbnQuaW5kZXgsIHR5cGU6ICdyb3cnfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1vZGUgPT09ICdzaW5nbGUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6c2VsZWN0aW9uJywgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LXVuc2VsZWN0Jywge29yaWdpbmFsRXZlbnQ6IGV2ZW50LCBkYXRhOiByb3dEYXRhLCBpbmRleDogZXZlbnQuaW5kZXgsIHR5cGU6ICdyb3cnfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6c2VsZWN0aW9uJywgcm93RGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LXNlbGVjdCcsIHtvcmlnaW5hbEV2ZW50OiBldmVudCwgZGF0YTogcm93RGF0YSwgaW5kZXg6IGV2ZW50LmluZGV4LCB0eXBlOiAncm93J30pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gJ211bHRpcGxlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uSW5kZXggPSB0aGlzLmZpbmRJbmRleEluU2VsZWN0aW9uKHJvd0RhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IF9zZWxlY3Rpb24gPSB0aGlzLnNlbGVjdGlvbi5maWx0ZXIoKHZhbCwgaSkgPT4gaSAhPSBzZWxlY3Rpb25JbmRleCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGlvbicsIF9zZWxlY3Rpb24pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3Jvdy11bnNlbGVjdCcsIHtvcmlnaW5hbEV2ZW50OiBldmVudCwgZGF0YTogcm93RGF0YSwgaW5kZXg6IGV2ZW50LmluZGV4LCB0eXBlOiAncm93J30pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX3NlbGVjdGlvbiA9IHRoaXMuc2VsZWN0aW9uID8gWy4uLnRoaXMuc2VsZWN0aW9uLCByb3dEYXRhXSA6IFtyb3dEYXRhXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6c2VsZWN0aW9uJywgX3NlbGVjdGlvbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LXNlbGVjdCcsIHtvcmlnaW5hbEV2ZW50OiBldmVudCwgZGF0YTogcm93RGF0YSwgaW5kZXg6IGV2ZW50LmluZGV4LCB0eXBlOiAncm93J30pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLnJvd1RvdWNoZWQgPSBmYWxzZTsKICAgICAgICB9LAogICAgICAgIG9uUm93UmlnaHRDbGljayhldmVudCkgewogICAgICAgICAgICBEb21IYW5kbGVyLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICAgIGV2ZW50Lm9yaWdpbmFsRXZlbnQudGFyZ2V0LmZvY3VzKCk7CgogICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6Y29udGV4dE1lbnVTZWxlY3Rpb24nLCBldmVudC5kYXRhKTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LWNvbnRleHRtZW51JywgZXZlbnQpOwogICAgICAgIH0sCiAgICAgICAgb25Sb3dUb3VjaEVuZCgpIHsKICAgICAgICAgICAgdGhpcy5yb3dUb3VjaGVkID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIG9uUm93S2V5RG93bihlKSB7CiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gZS5vcmlnaW5hbEV2ZW50OwogICAgICAgICAgICBjb25zdCByb3dEYXRhID0gZS5kYXRhOwogICAgICAgICAgICBjb25zdCByb3dJbmRleCA9IGUuaW5kZXg7CgogICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2RlKSB7CiAgICAgICAgICAgICAgICBjb25zdCByb3cgPSBldmVudC50YXJnZXQ7CgogICAgICAgICAgICAgICAgc3dpdGNoIChldmVudC53aGljaCkgewogICAgICAgICAgICAgICAgICAgIC8vZG93biBhcnJvdwogICAgICAgICAgICAgICAgICAgIGNhc2UgNDA6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0Um93ID0gdGhpcy5maW5kTmV4dFNlbGVjdGFibGVSb3cocm93KTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRSb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRSb3cuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgLy91cCBhcnJvdwogICAgICAgICAgICAgICAgICAgIGNhc2UgMzg6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmV2Um93ID0gdGhpcy5maW5kUHJldlNlbGVjdGFibGVSb3cocm93KTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZSb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZSb3cuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgLy9lbnRlcgogICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25Sb3dDbGljayh7b3JpZ2luYWxFdmVudDogZXZlbnQsIGRhdGE6IHJvd0RhdGEsIGluZGV4OiByb3dJbmRleH0pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAvL25vIG9wCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGZpbmROZXh0U2VsZWN0YWJsZVJvdyhyb3cpIHsKICAgICAgICAgICAgbGV0IG5leHRSb3cgPSByb3cubmV4dEVsZW1lbnRTaWJsaW5nOwogICAgICAgICAgICBpZiAobmV4dFJvdykgewogICAgICAgICAgICAgICAgaWYgKERvbUhhbmRsZXIuaGFzQ2xhc3MobmV4dFJvdywgJ3Atc2VsZWN0YWJsZS1yb3cnKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dFJvdzsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kTmV4dFNlbGVjdGFibGVSb3cobmV4dFJvdyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZmluZFByZXZTZWxlY3RhYmxlUm93KHJvdykgewogICAgICAgICAgICBsZXQgcHJldlJvdyA9IHJvdy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nOwogICAgICAgICAgICBpZiAocHJldlJvdykgewogICAgICAgICAgICAgICAgaWYgKERvbUhhbmRsZXIuaGFzQ2xhc3MocHJldlJvdywgJ3Atc2VsZWN0YWJsZS1yb3cnKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJldlJvdzsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kUHJldlNlbGVjdGFibGVSb3cocHJldlJvdyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgdG9nZ2xlUm93V2l0aFJhZGlvKGV2ZW50KSB7CiAgICAgICAgICAgIGNvbnN0IHJvd0RhdGEgPSBldmVudC5kYXRhOwoKICAgICAgICAgICAgaWYgKHRoaXMuaXNTZWxlY3RlZChyb3dEYXRhKSkgewogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGlvbicsIG51bGwpOwogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LXVuc2VsZWN0Jywge29yaWdpbmFsRXZlbnQ6IGV2ZW50LCBkYXRhOiByb3dEYXRhLCB0eXBlOiAncmFkaW9idXR0b24nfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6c2VsZWN0aW9uJywgcm93RGF0YSk7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdyb3ctc2VsZWN0Jywge29yaWdpbmFsRXZlbnQ6IGV2ZW50LCBkYXRhOiByb3dEYXRhLCB0eXBlOiAncmFkaW9idXR0b24nfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHRvZ2dsZVJvd1dpdGhDaGVja2JveChldmVudCkgewogICAgICAgICAgICBjb25zdCByb3dEYXRhID0gZXZlbnQuZGF0YTsKCiAgICAgICAgICAgIGlmICh0aGlzLmlzU2VsZWN0ZWQocm93RGF0YSkpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbkluZGV4ID0gdGhpcy5maW5kSW5kZXhJblNlbGVjdGlvbihyb3dEYXRhKTsKICAgICAgICAgICAgICAgIGNvbnN0IF9zZWxlY3Rpb24gPSB0aGlzLnNlbGVjdGlvbi5maWx0ZXIoKHZhbCwgaSkgPT4gaSAhPSBzZWxlY3Rpb25JbmRleCk7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6c2VsZWN0aW9uJywgX3NlbGVjdGlvbik7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdyb3ctdW5zZWxlY3QnLCB7b3JpZ2luYWxFdmVudDogZXZlbnQsIGRhdGE6IHJvd0RhdGEsIHR5cGU6ICdjaGVja2JveCd9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGxldCBfc2VsZWN0aW9uID0gdGhpcy5zZWxlY3Rpb24gPyBbLi4udGhpcy5zZWxlY3Rpb25dIDogW107CiAgICAgICAgICAgICAgICBfc2VsZWN0aW9uID0gWy4uLl9zZWxlY3Rpb24sIHJvd0RhdGFdOwogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGlvbicsIF9zZWxlY3Rpb24pOwogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LXNlbGVjdCcsIHtvcmlnaW5hbEV2ZW50OiBldmVudCwgZGF0YTogcm93RGF0YSwgdHlwZTogJ2NoZWNrYm94J30pOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB0b2dnbGVSb3dzV2l0aENoZWNrYm94KGV2ZW50KSB7CiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZERhdGEgPSB0aGlzLnByb2Nlc3NlZERhdGE7CiAgICAgICAgICAgIGNvbnN0IGNoZWNrZWQgPSB0aGlzLmFsbFJvd3NTZWxlY3RlZDsKICAgICAgICAgICAgY29uc3QgX3NlbGVjdGlvbiA9IGNoZWNrZWQgPyBbXSA6IChwcm9jZXNzZWREYXRhID8gWy4uLnByb2Nlc3NlZERhdGFdIDogWy4uLnRoaXMudmFsdWVdKTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGlvbicsIF9zZWxlY3Rpb24pOwoKICAgICAgICAgICAgaWYgKGNoZWNrZWQpCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdyb3ctdW5zZWxlY3QtYWxsJywge29yaWdpbmFsRXZlbnQ6IGV2ZW50fSk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3Jvdy1zZWxlY3QtYWxsJywge29yaWdpbmFsRXZlbnQ6IGV2ZW50LCBkYXRhOiBfc2VsZWN0aW9ufSk7CiAgICAgICAgfSwKICAgICAgICBpc1NpbmdsZVNlbGVjdGlvbk1vZGUoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbk1vZGUgPT09ICdzaW5nbGUnOwogICAgICAgIH0sCiAgICAgICAgaXNNdWx0aXBsZVNlbGVjdGlvbk1vZGUoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbk1vZGUgPT09ICdtdWx0aXBsZSc7CiAgICAgICAgfSwKICAgICAgICBpc1NlbGVjdGVkKHJvd0RhdGEpIHsKICAgICAgICAgICAgaWYgKHJvd0RhdGEgJiYgdGhpcy5zZWxlY3Rpb24pIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmRhdGFLZXkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kX3NlbGVjdGlvbktleXMgPyB0aGlzLmRfc2VsZWN0aW9uS2V5c1tPYmplY3RVdGlscy5yZXNvbHZlRmllbGREYXRhKHJvd0RhdGEsIHRoaXMuZGF0YUtleSldICE9PSB1bmRlZmluZWQgOiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbiBpbnN0YW5jZW9mIEFycmF5KQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kSW5kZXhJblNlbGVjdGlvbihyb3dEYXRhKSA+IC0xOwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXF1YWxzKHJvd0RhdGEsIHRoaXMuc2VsZWN0aW9uKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0sCiAgICAgICAgZmluZEluZGV4SW5TZWxlY3Rpb24ocm93RGF0YSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kSW5kZXgocm93RGF0YSwgdGhpcy5zZWxlY3Rpb24pOwogICAgICAgIH0sCiAgICAgICAgZmluZEluZGV4KHJvd0RhdGEsIGNvbGxlY3Rpb24pIHsKICAgICAgICAgICAgbGV0IGluZGV4ID0gLTE7CiAgICAgICAgICAgIGlmIChjb2xsZWN0aW9uICYmIGNvbGxlY3Rpb24ubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbGxlY3Rpb24ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lcXVhbHMocm93RGF0YSwgY29sbGVjdGlvbltpXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBpbmRleDsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZVNlbGVjdGlvbktleXMoc2VsZWN0aW9uKSB7CiAgICAgICAgICAgIHRoaXMuZF9zZWxlY3Rpb25LZXlzID0ge307CiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHNlbGVjdGlvbikpIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGRhdGEgb2Ygc2VsZWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kX3NlbGVjdGlvbktleXNbU3RyaW5nKE9iamVjdFV0aWxzLnJlc29sdmVGaWVsZERhdGEoZGF0YSwgdGhpcy5kYXRhS2V5KSldID0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuZF9zZWxlY3Rpb25LZXlzW1N0cmluZyhPYmplY3RVdGlscy5yZXNvbHZlRmllbGREYXRhKHNlbGVjdGlvbiwgdGhpcy5kYXRhS2V5KSldID0gMTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgdXBkYXRlRXhwYW5kZWRSb3dLZXlzKGV4cGFuZGVkUm93cykgewogICAgICAgICAgICBpZiAoZXhwYW5kZWRSb3dzICYmIGV4cGFuZGVkUm93cy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHRoaXMuZF9leHBhbmRlZFJvd0tleXMgPSB7fTsKICAgICAgICAgICAgICAgIGZvciAobGV0IGRhdGEgb2YgZXhwYW5kZWRSb3dzKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kX2V4cGFuZGVkUm93S2V5c1tTdHJpbmcoT2JqZWN0VXRpbHMucmVzb2x2ZUZpZWxkRGF0YShkYXRhLCB0aGlzLmRhdGFLZXkpKV0gPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5kX2V4cGFuZGVkUm93S2V5cyA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHVwZGF0ZUVkaXRpbmdSb3dLZXlzKGVkaXRpbmdSb3dzKSB7CiAgICAgICAgICAgIGlmIChlZGl0aW5nUm93cyAmJiBlZGl0aW5nUm93cy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHRoaXMuZF9lZGl0aW5nUm93S2V5cyA9IHt9OwogICAgICAgICAgICAgICAgZm9yIChsZXQgZGF0YSBvZiBlZGl0aW5nUm93cykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZF9lZGl0aW5nUm93S2V5c1tTdHJpbmcoT2JqZWN0VXRpbHMucmVzb2x2ZUZpZWxkRGF0YShkYXRhLCB0aGlzLmRhdGFLZXkpKV0gPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5kX2VkaXRpbmdSb3dLZXlzID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZXF1YWxzKGRhdGExLCBkYXRhMikgewogICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlU2VsZWN0aW9uQnkgPT09ICdlcXVhbHMnID8gKGRhdGExID09PSBkYXRhMikgOiBPYmplY3RVdGlscy5lcXVhbHMoZGF0YTEsIGRhdGEyLCB0aGlzLmRhdGFLZXkpOwogICAgICAgIH0sCiAgICAgICAgc2VsZWN0UmFuZ2UoZXZlbnQpIHsKICAgICAgICAgICAgbGV0IHJhbmdlU3RhcnQsIHJhbmdlRW5kOwoKICAgICAgICAgICAgaWYgKHRoaXMucmFuZ2VSb3dJbmRleCA+IHRoaXMuYW5jaG9yUm93SW5kZXgpIHsKICAgICAgICAgICAgICAgIHJhbmdlU3RhcnQgPSB0aGlzLmFuY2hvclJvd0luZGV4OwogICAgICAgICAgICAgICAgcmFuZ2VFbmQgPSB0aGlzLnJhbmdlUm93SW5kZXg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZih0aGlzLnJhbmdlUm93SW5kZXggPCB0aGlzLmFuY2hvclJvd0luZGV4KSB7CiAgICAgICAgICAgICAgICByYW5nZVN0YXJ0ID0gdGhpcy5yYW5nZVJvd0luZGV4OwogICAgICAgICAgICAgICAgcmFuZ2VFbmQgPSB0aGlzLmFuY2hvclJvd0luZGV4OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgcmFuZ2VTdGFydCA9IHRoaXMucmFuZ2VSb3dJbmRleDsKICAgICAgICAgICAgICAgIHJhbmdlRW5kID0gdGhpcy5yYW5nZVJvd0luZGV4OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy5sYXp5ICYmIHRoaXMucGFnaW5hdG9yKSB7CiAgICAgICAgICAgICAgICByYW5nZVN0YXJ0IC09IHRoaXMuZmlyc3Q7CiAgICAgICAgICAgICAgICByYW5nZUVuZCAtPSB0aGlzLmZpcnN0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMucHJvY2Vzc2VkRGF0YTsKICAgICAgICAgICAgbGV0IF9zZWxlY3Rpb24gPSBbXTsKICAgICAgICAgICAgZm9yKGxldCBpID0gcmFuZ2VTdGFydDsgaSA8PSByYW5nZUVuZDsgaSsrKSB7CiAgICAgICAgICAgICAgICBsZXQgcmFuZ2VSb3dEYXRhID0gdmFsdWVbaV07CiAgICAgICAgICAgICAgICBfc2VsZWN0aW9uLnB1c2gocmFuZ2VSb3dEYXRhKTsKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3Jvdy1zZWxlY3QnLCB7b3JpZ2luYWxFdmVudDogZXZlbnQsIGRhdGE6IHJhbmdlUm93RGF0YSwgdHlwZTogJ3Jvdyd9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGlvbicsIF9zZWxlY3Rpb24pOwogICAgICAgIH0sCiAgICAgICAgZXhwb3J0Q1NWKG9wdGlvbnMpIHsKICAgICAgICAgICAgbGV0IGRhdGEgPSB0aGlzLnByb2Nlc3NlZERhdGE7CiAgICAgICAgICAgIGxldCBjc3YgPSAnXHVmZWZmJzsKCiAgICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuc2VsZWN0aW9uT25seSkgewogICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuc2VsZWN0aW9uIHx8IFtdOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL2hlYWRlcnMKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNvbHVtbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBjb2x1bW4gPSB0aGlzLmNvbHVtbnNbaV07CiAgICAgICAgICAgICAgICBpZiAoY29sdW1uLmV4cG9ydGFibGUgIT09IGZhbHNlICYmIGNvbHVtbi5maWVsZCkgewogICAgICAgICAgICAgICAgICAgIGNzdiArPSAnIicgKyAoY29sdW1uLmhlYWRlciB8fCBjb2x1bW4uZmllbGQpICsgJyInOwoKICAgICAgICAgICAgICAgICAgICBpZiAoaSA8ICh0aGlzLmNvbHVtbnMubGVuZ3RoIC0gMSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3N2ICs9IHRoaXMuY3N2U2VwYXJhdG9yOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9ib2R5CiAgICAgICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2gocmVjb3JkID0+IHsKICAgICAgICAgICAgICAgICAgICBjc3YgKz0gJ1xuJzsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY29sdW1ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29sdW1uID0gdGhpcy5jb2x1bW5zW2ldOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29sdW1uLmV4cG9ydGFibGUgIT09IGZhbHNlICYmIGNvbHVtbi5maWVsZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNlbGxEYXRhID0gT2JqZWN0VXRpbHMucmVzb2x2ZUZpZWxkRGF0YShyZWNvcmQsIGNvbHVtbi5maWVsZCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGxEYXRhICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5leHBvcnRGdW5jdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsRGF0YSA9IHRoaXMuZXhwb3J0RnVuY3Rpb24oewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogY2VsbERhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZDogY29sdW1uLmZpZWxkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxEYXRhID0gU3RyaW5nKGNlbGxEYXRhKS5yZXBsYWNlKC8iL2csICciIicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxEYXRhID0gJyc7CgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzdiArPSAnIicgKyBjZWxsRGF0YSArICciJzsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA8ICh0aGlzLmNvbHVtbnMubGVuZ3RoIC0gMSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3YgKz0gdGhpcy5jc3ZTZXBhcmF0b3I7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGJsb2IgPSBuZXcgQmxvYihbY3N2XSwgewogICAgICAgICAgICAgICAgdHlwZTogJ3RleHQvY3N2O2NoYXJzZXQ9dXRmLTg7JwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmICh3aW5kb3cubmF2aWdhdG9yLm1zU2F2ZU9yT3BlbkJsb2IpIHsKICAgICAgICAgICAgICAgIG5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iKGJsb2IsIHRoaXMuZXhwb3J0RmlsZW5hbWUgKyAnLmNzdicpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgbGV0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgICAgICBsaW5rLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOwogICAgICAgICAgICAgICAgaWYgKGxpbmsuZG93bmxvYWQgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKSk7CiAgICAgICAgICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgdGhpcy5leHBvcnRGaWxlbmFtZSArICcuY3N2Jyk7CiAgICAgICAgICAgICAgICAgICAgbGluay5jbGljaygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY3N2ID0gJ2RhdGE6dGV4dC9jc3Y7Y2hhcnNldD11dGYtOCwnICsgY3N2OwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKGVuY29kZVVSSShjc3YpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJlc2V0UGFnZSgpIHsKICAgICAgICAgICAgdGhpcy5kX2ZpcnN0ID0gMDsKICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOmZpcnN0JywgdGhpcy5kX2ZpcnN0KTsKICAgICAgICB9LAogICAgICAgIG9uQ29sdW1uUmVzaXplU3RhcnQoZXZlbnQpIHsKICAgICAgICAgICAgbGV0IGNvbnRhaW5lckxlZnQgPSBEb21IYW5kbGVyLmdldE9mZnNldCh0aGlzLiRlbCkubGVmdDsKICAgICAgICAgICAgdGhpcy5yZXNpemVDb2x1bW5FbGVtZW50ID0gZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQ7CiAgICAgICAgICAgIHRoaXMuY29sdW1uUmVzaXppbmcgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmxhc3RSZXNpemVIZWxwZXJYID0gKGV2ZW50LnBhZ2VYIC0gY29udGFpbmVyTGVmdCArIHRoaXMuJGVsLnNjcm9sbExlZnQpOwoKICAgICAgICAgICAgdGhpcy5iaW5kQ29sdW1uUmVzaXplRXZlbnRzKCk7CiAgICAgICAgfSwKICAgICAgICBvbkNvbHVtblJlc2l6ZShldmVudCkgewogICAgICAgICAgICBsZXQgY29udGFpbmVyTGVmdCA9IERvbUhhbmRsZXIuZ2V0T2Zmc2V0KHRoaXMuJGVsKS5sZWZ0OwogICAgICAgICAgICBEb21IYW5kbGVyLmFkZENsYXNzKHRoaXMuJGVsLCAncC11bnNlbGVjdGFibGUtdGV4dCcpOwogICAgICAgICAgICB0aGlzLiRyZWZzLnJlc2l6ZUhlbHBlci5zdHlsZS5oZWlnaHQgPSB0aGlzLiRlbC5vZmZzZXRIZWlnaHQgKyAncHgnOwogICAgICAgICAgICB0aGlzLiRyZWZzLnJlc2l6ZUhlbHBlci5zdHlsZS50b3AgPSAwICsgJ3B4JzsKICAgICAgICAgICAgdGhpcy4kcmVmcy5yZXNpemVIZWxwZXIuc3R5bGUubGVmdCA9IChldmVudC5wYWdlWCAtIGNvbnRhaW5lckxlZnQgKyB0aGlzLiRlbC5zY3JvbGxMZWZ0KSArICdweCc7CgogICAgICAgICAgICB0aGlzLiRyZWZzLnJlc2l6ZUhlbHBlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICB9LAogICAgICAgIG9uQ29sdW1uUmVzaXplRW5kKCkgewogICAgICAgICAgICBsZXQgZGVsdGEgPSB0aGlzLiRyZWZzLnJlc2l6ZUhlbHBlci5vZmZzZXRMZWZ0IC0gdGhpcy5sYXN0UmVzaXplSGVscGVyWDsKICAgICAgICAgICAgbGV0IGNvbHVtbldpZHRoID0gdGhpcy5yZXNpemVDb2x1bW5FbGVtZW50Lm9mZnNldFdpZHRoOwogICAgICAgICAgICBsZXQgbmV3Q29sdW1uV2lkdGggPSBjb2x1bW5XaWR0aCArIGRlbHRhOwogICAgICAgICAgICBsZXQgbWluV2lkdGggPSB0aGlzLnJlc2l6ZUNvbHVtbkVsZW1lbnQuc3R5bGUubWluV2lkdGh8fDE1OwoKICAgICAgICAgICAgaWYgKGNvbHVtbldpZHRoICsgZGVsdGEgPiBwYXJzZUludChtaW5XaWR0aCwgMTApKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2x1bW5SZXNpemVNb2RlID09PSAnZml0JykgewogICAgICAgICAgICAgICAgICAgIGxldCBuZXh0Q29sdW1uID0gdGhpcy5yZXNpemVDb2x1bW5FbGVtZW50Lm5leHRFbGVtZW50U2libGluZzsKICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dENvbHVtbldpZHRoID0gbmV4dENvbHVtbi5vZmZzZXRXaWR0aCAtIGRlbHRhOwoKICAgICAgICAgICAgICAgICAgICBpZiAobmV3Q29sdW1uV2lkdGggPiAxNSAmJiBuZXh0Q29sdW1uV2lkdGggPiAxNSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnNjcm9sbGFibGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjcm9sbGFibGVWaWV3ID0gdGhpcy5maW5kUGFyZW50U2Nyb2xsYWJsZVZpZXcodGhpcy5yZXNpemVDb2x1bW5FbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjcm9sbGFibGVCb2R5VGFibGUgPSBEb21IYW5kbGVyLmZpbmRTaW5nbGUoc2Nyb2xsYWJsZVZpZXcsICd0YWJsZS5wLWRhdGF0YWJsZS1zY3JvbGxhYmxlLWJvZHktdGFibGUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjcm9sbGFibGVIZWFkZXJUYWJsZSA9IERvbUhhbmRsZXIuZmluZFNpbmdsZShzY3JvbGxhYmxlVmlldywgJ3RhYmxlLnAtZGF0YXRhYmxlLXNjcm9sbGFibGUtaGVhZGVyLXRhYmxlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzY3JvbGxhYmxlRm9vdGVyVGFibGUgPSBEb21IYW5kbGVyLmZpbmRTaW5nbGUoc2Nyb2xsYWJsZVZpZXcsICd0YWJsZS5wLWRhdGF0YWJsZS1zY3JvbGxhYmxlLWZvb3Rlci10YWJsZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzaXplQ29sdW1uSW5kZXggPSBEb21IYW5kbGVyLmluZGV4KHRoaXMucmVzaXplQ29sdW1uRWxlbWVudCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemVDb2xHcm91cChzY3JvbGxhYmxlSGVhZGVyVGFibGUsIHJlc2l6ZUNvbHVtbkluZGV4LCBuZXdDb2x1bW5XaWR0aCwgbmV4dENvbHVtbldpZHRoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplQ29sR3JvdXAoc2Nyb2xsYWJsZUJvZHlUYWJsZSwgcmVzaXplQ29sdW1uSW5kZXgsIG5ld0NvbHVtbldpZHRoLCBuZXh0Q29sdW1uV2lkdGgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemVDb2xHcm91cChzY3JvbGxhYmxlRm9vdGVyVGFibGUsIHJlc2l6ZUNvbHVtbkluZGV4LCBuZXdDb2x1bW5XaWR0aCwgbmV4dENvbHVtbldpZHRoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplQ29sdW1uRWxlbWVudC5zdHlsZS53aWR0aCA9IG5ld0NvbHVtbldpZHRoICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5leHRDb2x1bW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0Q29sdW1uLnN0eWxlLndpZHRoID0gbmV4dENvbHVtbldpZHRoICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuY29sdW1uUmVzaXplTW9kZSA9PT0gJ2V4cGFuZCcpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxhYmxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaXplU2Nyb2xsYWJsZVRhYmxlKHRoaXMucmVzaXplQ29sdW1uRWxlbWVudCwgbmV3Q29sdW1uV2lkdGgsIGRlbHRhKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMudGFibGUuc3R5bGUud2lkdGggPSB0aGlzLiRyZWZzLnRhYmxlLm9mZnNldFdpZHRoICsgZGVsdGEgKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZUNvbHVtbkVsZW1lbnQuc3R5bGUud2lkdGggPSBuZXdDb2x1bW5XaWR0aCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2NvbHVtbi1yZXNpemUtZW5kJywgewogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMucmVzaXplQ29sdW1uRWxlbWVudCwKICAgICAgICAgICAgICAgICAgICBkZWx0YTogZGVsdGEKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLiRyZWZzLnJlc2l6ZUhlbHBlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICB0aGlzLnJlc2l6ZUNvbHVtbiA9IG51bGw7CiAgICAgICAgICAgIERvbUhhbmRsZXIucmVtb3ZlQ2xhc3ModGhpcy4kZWwsICdwLXVuc2VsZWN0YWJsZS10ZXh0Jyk7CgogICAgICAgICAgICB0aGlzLnVuYmluZENvbHVtblJlc2l6ZUV2ZW50cygpOwoKICAgICAgICAgICAgaWYgKHRoaXMuaXNTdGF0ZWZ1bCgpKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNhdmVTdGF0ZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByZXNpemVDb2xHcm91cCh0YWJsZSwgcmVzaXplQ29sdW1uSW5kZXgsIG5ld0NvbHVtbldpZHRoLCBuZXh0Q29sdW1uV2lkdGgpIHsKICAgICAgICAgICAgaWYodGFibGUpIHsKICAgICAgICAgICAgICAgIGxldCBjb2xHcm91cCA9IHRhYmxlLmNoaWxkcmVuWzBdLm5vZGVOYW1lID09PSAnQ09MR1JPVVAnID8gdGFibGUuY2hpbGRyZW5bMF0gOiBudWxsOwoKICAgICAgICAgICAgICAgIGlmKGNvbEdyb3VwKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbCA9IGNvbEdyb3VwLmNoaWxkcmVuW3Jlc2l6ZUNvbHVtbkluZGV4XTsKICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dENvbCA9IGNvbC5uZXh0RWxlbWVudFNpYmxpbmc7CiAgICAgICAgICAgICAgICAgICAgY29sLnN0eWxlLndpZHRoID0gbmV3Q29sdW1uV2lkdGggKyAncHgnOwoKICAgICAgICAgICAgICAgICAgICBpZiAobmV4dENvbCAmJiBuZXh0Q29sdW1uV2lkdGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbmV4dENvbC5zdHlsZS53aWR0aCA9IG5leHRDb2x1bW5XaWR0aCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJTY3JvbGxhYmxlIHRhYmxlcyByZXF1aXJlIGEgY29sZ3JvdXAgdG8gc3VwcG9ydCByZXNpemFibGUgY29sdW1ucyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBiaW5kQ29sdW1uUmVzaXplRXZlbnRzKCkgewogICAgICAgICAgICBpZiAoIXRoaXMuZG9jdW1lbnRDb2x1bW5SZXNpemVMaXN0ZW5lcikgewogICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudENvbHVtblJlc2l6ZUxpc3RlbmVyID0gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuY29sdW1uUmVzaXppbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNvbHVtblJlc2l6ZShldmVudCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICghdGhpcy5kb2N1bWVudENvbHVtblJlc2l6ZUVuZExpc3RlbmVyKSB7CiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50Q29sdW1uUmVzaXplRW5kTGlzdGVuZXIgPSBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuY29sdW1uUmVzaXppbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5SZXNpemluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ29sdW1uUmVzaXplRW5kKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSwKICAgICAgICB1bmJpbmRDb2x1bW5SZXNpemVFdmVudHMoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmRvY3VtZW50Q29sdW1uUmVzaXplTGlzdGVuZXIpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2RvY3VtZW50JywgdGhpcy5kb2N1bWVudENvbHVtblJlc2l6ZUxpc3RlbmVyKTsKICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRDb2x1bW5SZXNpemVMaXN0ZW5lciA9IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmRvY3VtZW50Q29sdW1uUmVzaXplRW5kTGlzdGVuZXIpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2RvY3VtZW50JywgdGhpcy5kb2N1bWVudENvbHVtblJlc2l6ZUVuZExpc3RlbmVyKTsKICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50Q29sdW1uUmVzaXplRW5kTGlzdGVuZXIgPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbkNvbHVtbkhlYWRlck1vdXNlRG93bihlKSB7CiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gZS5vcmlnaW5hbEV2ZW50OwogICAgICAgICAgICBjb25zdCBjb2x1bW4gPSBlLmNvbHVtbjsKCiAgICAgICAgICAgIGlmICh0aGlzLnJlb3JkZXJhYmxlQ29sdW1ucyAmJiBjb2x1bW4ucmVvcmRlcmFibGVDb2x1bW4pIHsKICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQubm9kZU5hbWUgPT09ICdJTlBVVCcgfHwgZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID09PSAnVEVYVEFSRUEnIHx8IERvbUhhbmRsZXIuaGFzQ2xhc3MoZXZlbnQudGFyZ2V0LCAncC1jb2x1bW4tcmVzaXplcicpKQogICAgICAgICAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuZHJhZ2dhYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldC5kcmFnZ2FibGUgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbkNvbHVtbkhlYWRlckRyYWdTdGFydChldmVudCkgewogICAgICAgICAgICBpZiAodGhpcy5jb2x1bW5SZXNpemluZykgewogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5jb2xSZW9yZGVySWNvbldpZHRoID0gRG9tSGFuZGxlci5nZXRIaWRkZW5FbGVtZW50T3V0ZXJXaWR0aCh0aGlzLiRyZWZzLnJlb3JkZXJJbmRpY2F0b3JVcCk7CiAgICAgICAgICAgIHRoaXMuY29sUmVvcmRlckljb25IZWlnaHQgPSBEb21IYW5kbGVyLmdldEhpZGRlbkVsZW1lbnRPdXRlckhlaWdodCh0aGlzLiRyZWZzLnJlb3JkZXJJbmRpY2F0b3JVcCk7CgogICAgICAgICAgICB0aGlzLmRyYWdnZWRDb2x1bW4gPSB0aGlzLmZpbmRQYXJlbnRIZWFkZXIoZXZlbnQudGFyZ2V0KTsKICAgICAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyLnNldERhdGEoJ3RleHQnLCAnYicpOyAvLyBGaXJlZm94IHJlcXVpcmVzIHRoaXMgdG8gbWFrZSBkcmFnZ2luZyBwb3NzaWJsZQogICAgICAgIH0sCiAgICAgICAgb25Db2x1bW5IZWFkZXJEcmFnT3ZlcihldmVudCkgewogICAgICAgICAgICBsZXQgZHJvcEhlYWRlciA9IHRoaXMuZmluZFBhcmVudEhlYWRlcihldmVudC50YXJnZXQpOwogICAgICAgICAgICBpZih0aGlzLnJlb3JkZXJhYmxlQ29sdW1ucyAmJiB0aGlzLmRyYWdnZWRDb2x1bW4gJiYgZHJvcEhlYWRlcikgewogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIGxldCBjb250YWluZXJPZmZzZXQgPSBEb21IYW5kbGVyLmdldE9mZnNldCh0aGlzLiRlbCk7CiAgICAgICAgICAgICAgICBsZXQgZHJvcEhlYWRlck9mZnNldCA9IERvbUhhbmRsZXIuZ2V0T2Zmc2V0KGRyb3BIZWFkZXIpOwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLmRyYWdnZWRDb2x1bW4gIT09IGRyb3BIZWFkZXIpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0TGVmdCA9ICBkcm9wSGVhZGVyT2Zmc2V0LmxlZnQgLSBjb250YWluZXJPZmZzZXQubGVmdDsKICAgICAgICAgICAgICAgICAgICBsZXQgY29sdW1uQ2VudGVyID0gZHJvcEhlYWRlck9mZnNldC5sZWZ0ICsgZHJvcEhlYWRlci5vZmZzZXRXaWR0aCAvIDI7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMucmVvcmRlckluZGljYXRvclVwLnN0eWxlLnRvcCA9IGRyb3BIZWFkZXJPZmZzZXQudG9wIC0gY29udGFpbmVyT2Zmc2V0LnRvcCAtICh0aGlzLmNvbFJlb3JkZXJJY29uSGVpZ2h0IC0gMSkgKyAncHgnOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMucmVvcmRlckluZGljYXRvckRvd24uc3R5bGUudG9wID0gZHJvcEhlYWRlck9mZnNldC50b3AgLSBjb250YWluZXJPZmZzZXQudG9wICsgZHJvcEhlYWRlci5vZmZzZXRIZWlnaHQgKyAncHgnOwoKICAgICAgICAgICAgICAgICAgICBpZihldmVudC5wYWdlWCA+IGNvbHVtbkNlbnRlcikgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnJlb3JkZXJJbmRpY2F0b3JVcC5zdHlsZS5sZWZ0ID0gKHRhcmdldExlZnQgKyBkcm9wSGVhZGVyLm9mZnNldFdpZHRoIC0gTWF0aC5jZWlsKHRoaXMuY29sUmVvcmRlckljb25XaWR0aCAvIDIpKSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMucmVvcmRlckluZGljYXRvckRvd24uc3R5bGUubGVmdCA9ICh0YXJnZXRMZWZ0ICsgZHJvcEhlYWRlci5vZmZzZXRXaWR0aCAtIE1hdGguY2VpbCh0aGlzLmNvbFJlb3JkZXJJY29uV2lkdGggLyAyKSkrICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJvcFBvc2l0aW9uID0gMTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMucmVvcmRlckluZGljYXRvclVwLnN0eWxlLmxlZnQgPSAodGFyZ2V0TGVmdCAtIE1hdGguY2VpbCh0aGlzLmNvbFJlb3JkZXJJY29uV2lkdGggLyAyKSkgKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnJlb3JkZXJJbmRpY2F0b3JEb3duLnN0eWxlLmxlZnQgPSAodGFyZ2V0TGVmdCAtIE1hdGguY2VpbCh0aGlzLmNvbFJlb3JkZXJJY29uV2lkdGggLyAyKSkrICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJvcFBvc2l0aW9uID0gLTE7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnJlb3JkZXJJbmRpY2F0b3JVcC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnJlb3JkZXJJbmRpY2F0b3JEb3duLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbkNvbHVtbkhlYWRlckRyYWdMZWF2ZShldmVudCkgewogICAgICAgICAgICBpZih0aGlzLnJlb3JkZXJhYmxlQ29sdW1ucyAmJiB0aGlzLmRyYWdnZWRDb2x1bW4pIHsKICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnJlb3JkZXJJbmRpY2F0b3JVcC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5yZW9yZGVySW5kaWNhdG9yRG93bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbkNvbHVtbkhlYWRlckRyb3AoZXZlbnQpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dlZENvbHVtbikgewogICAgICAgICAgICAgICAgbGV0IGRyYWdJbmRleCA9IERvbUhhbmRsZXIuaW5kZXgodGhpcy5kcmFnZ2VkQ29sdW1uKTsKICAgICAgICAgICAgICAgIGxldCBkcm9wSW5kZXggPSBEb21IYW5kbGVyLmluZGV4KHRoaXMuZmluZFBhcmVudEhlYWRlcihldmVudC50YXJnZXQpKTsKICAgICAgICAgICAgICAgIGxldCBhbGxvd0Ryb3AgPSAoZHJhZ0luZGV4ICE9PSBkcm9wSW5kZXgpOwogICAgICAgICAgICAgICAgaWYgKGFsbG93RHJvcCAmJiAoKGRyb3BJbmRleCAtIGRyYWdJbmRleCA9PT0gMSAmJiB0aGlzLmRyb3BQb3NpdGlvbiA9PT0gLTEpIHx8IChkcmFnSW5kZXggLSBkcm9wSW5kZXggPT09IDEgJiYgdGhpcy5kcm9wUG9zaXRpb24gPT09IDEpKSkgewogICAgICAgICAgICAgICAgICAgIGFsbG93RHJvcCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChhbGxvd0Ryb3ApIHsKICAgICAgICAgICAgICAgICAgICBPYmplY3RVdGlscy5yZW9yZGVyQXJyYXkodGhpcy5kX2NvbHVtbk9yZGVyLCBkcmFnSW5kZXgsIGRyb3BJbmRleCk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2NvbHVtbi1yZW9yZGVyJywgewogICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldmVudCwKICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ0luZGV4OiBkcmFnSW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BJbmRleDogZHJvcEluZGV4CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5yZW9yZGVySW5kaWNhdG9yVXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMucmVvcmRlckluZGljYXRvckRvd24uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIHRoaXMuZHJhZ2dlZENvbHVtbi5kcmFnZ2FibGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuZHJhZ2dlZENvbHVtbiA9IG51bGw7CiAgICAgICAgICAgICAgICB0aGlzLmRyb3BQb3NpdGlvbiA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGZpbmRQYXJlbnRIZWFkZXIoZWxlbWVudCkgewogICAgICAgICAgICBpZihlbGVtZW50Lm5vZGVOYW1lID09PSAnVEgnKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudDsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQ7CiAgICAgICAgICAgICAgICB3aGlsZShwYXJlbnQubm9kZU5hbWUgIT09ICdUSCcpIHsKICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudDsKICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudCkgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50OwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmaW5kUGFyZW50U2Nyb2xsYWJsZVZpZXcoY29sdW1uKSB7CiAgICAgICAgICAgIGlmIChjb2x1bW4pIHsKICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSBjb2x1bW4ucGFyZW50RWxlbWVudDsKICAgICAgICAgICAgICAgIHdoaWxlIChwYXJlbnQgJiYgIURvbUhhbmRsZXIuaGFzQ2xhc3MocGFyZW50LCAncC1kYXRhdGFibGUtc2Nyb2xsYWJsZS12aWV3JykpIHsKICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGZpbmRDb2x1bW5CeUtleShjb2x1bW5zLCBrZXkpIHsKICAgICAgICAgICAgaWYoY29sdW1ucyAmJiBjb2x1bW5zLmxlbmd0aCkgewogICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGNvbHVtbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBsZXQgY2hpbGQgPSBjb2x1bW5zW2ldOwogICAgICAgICAgICAgICAgICAgIGlmKGNoaWxkLmNvbHVtbktleSA9PT0ga2V5IHx8IGNoaWxkLmZpZWxkID09PSBrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSwKICAgICAgICByZXNpemVTY3JvbGxhYmxlVGFibGUoY29sdW1uLCBuZXdDb2x1bW5XaWR0aCwgZGVsdGEpIHsKICAgICAgICAgICAgY29uc3Qgc2Nyb2xsYWJsZVZpZXcgPSBjb2x1bW4gPyB0aGlzLmZpbmRQYXJlbnRTY3JvbGxhYmxlVmlldyhjb2x1bW4pIDogdGhpcy4kZWw7CiAgICAgICAgICAgIGNvbnN0IHNjcm9sbGFibGVCb2R5ID0gRG9tSGFuZGxlci5maW5kU2luZ2xlKHNjcm9sbGFibGVWaWV3LCAnLnAtZGF0YXRhYmxlLXNjcm9sbGFibGUtYm9keScpOwogICAgICAgICAgICBjb25zdCBzY3JvbGxhYmxlSGVhZGVyID0gRG9tSGFuZGxlci5maW5kU2luZ2xlKHNjcm9sbGFibGVWaWV3LCAnLnAtZGF0YXRhYmxlLXNjcm9sbGFibGUtaGVhZGVyJyk7CiAgICAgICAgICAgIGNvbnN0IHNjcm9sbGFibGVGb290ZXIgPSBEb21IYW5kbGVyLmZpbmRTaW5nbGUoc2Nyb2xsYWJsZVZpZXcsICcucC1kYXRhdGFibGUtc2Nyb2xsYWJsZS1mb290ZXInKTsKICAgICAgICAgICAgY29uc3Qgc2Nyb2xsYWJsZUJvZHlUYWJsZSA9IERvbUhhbmRsZXIuZmluZFNpbmdsZShzY3JvbGxhYmxlQm9keSwgJ3RhYmxlLnAtZGF0YXRhYmxlLXNjcm9sbGFibGUtYm9keS10YWJsZScpOwogICAgICAgICAgICBjb25zdCBzY3JvbGxhYmxlSGVhZGVyVGFibGUgPSBEb21IYW5kbGVyLmZpbmRTaW5nbGUoc2Nyb2xsYWJsZUhlYWRlciwgJ3RhYmxlLnAtZGF0YXRhYmxlLXNjcm9sbGFibGUtaGVhZGVyLXRhYmxlJyk7CiAgICAgICAgICAgIGNvbnN0IHNjcm9sbGFibGVGb290ZXJUYWJsZSA9IERvbUhhbmRsZXIuZmluZFNpbmdsZShzY3JvbGxhYmxlRm9vdGVyLCAndGFibGUucC1kYXRhdGFibGUtc2Nyb2xsYWJsZS1mb290ZXItdGFibGUnKTsKCiAgICAgICAgICAgIGNvbnN0IHNjcm9sbGFibGVCb2R5VGFibGVXaWR0aCA9IGNvbHVtbiA/IHNjcm9sbGFibGVCb2R5VGFibGUub2Zmc2V0V2lkdGggKyBkZWx0YSA6IG5ld0NvbHVtbldpZHRoOwogICAgICAgICAgICBjb25zdCBzY3JvbGxhYmxlSGVhZGVyVGFibGVXaWR0aCA9IGNvbHVtbiA/IHNjcm9sbGFibGVIZWFkZXJUYWJsZS5vZmZzZXRXaWR0aCArIGRlbHRhIDogbmV3Q29sdW1uV2lkdGg7CiAgICAgICAgICAgIGNvbnN0IGlzQ29udGFpbmVySW5WaWV3cG9ydCA9IHRoaXMuJGVsLm9mZnNldFdpZHRoID49IHBhcnNlRmxvYXQoc2Nyb2xsYWJsZUJvZHlUYWJsZVdpZHRoKTsKCiAgICAgICAgICAgIGxldCBzZXRXaWR0aCA9IChjb250YWluZXIsIHRhYmxlLCB3aWR0aCwgaXNDb250YWluZXJJblZpZXdwb3J0KSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyICYmIHRhYmxlKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gaXNDb250YWluZXJJblZpZXdwb3J0ID8gd2lkdGggKyBEb21IYW5kbGVyLmNhbGN1bGF0ZVNjcm9sbGJhcldpZHRoKHNjcm9sbGFibGVCb2R5KSArICdweCcgOiAnYXV0bycKICAgICAgICAgICAgICAgICAgICB0YWJsZS5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHNldFdpZHRoKHNjcm9sbGFibGVCb2R5LCBzY3JvbGxhYmxlQm9keVRhYmxlLCBzY3JvbGxhYmxlQm9keVRhYmxlV2lkdGgsIGlzQ29udGFpbmVySW5WaWV3cG9ydCk7CiAgICAgICAgICAgIHNldFdpZHRoKHNjcm9sbGFibGVIZWFkZXIsIHNjcm9sbGFibGVIZWFkZXJUYWJsZSwgc2Nyb2xsYWJsZUhlYWRlclRhYmxlV2lkdGgsIGlzQ29udGFpbmVySW5WaWV3cG9ydCk7CiAgICAgICAgICAgIHNldFdpZHRoKHNjcm9sbGFibGVGb290ZXIsIHNjcm9sbGFibGVGb290ZXJUYWJsZSwgc2Nyb2xsYWJsZUhlYWRlclRhYmxlV2lkdGgsIGlzQ29udGFpbmVySW5WaWV3cG9ydCk7CgogICAgICAgICAgICBpZiAoY29sdW1uKSB7CiAgICAgICAgICAgICAgICBsZXQgcmVzaXplQ29sdW1uSW5kZXggPSBEb21IYW5kbGVyLmluZGV4KGNvbHVtbik7CgogICAgICAgICAgICAgICAgdGhpcy5yZXNpemVDb2xHcm91cChzY3JvbGxhYmxlSGVhZGVyVGFibGUsIHJlc2l6ZUNvbHVtbkluZGV4LCBuZXdDb2x1bW5XaWR0aCwgbnVsbCk7CiAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZUNvbEdyb3VwKHNjcm9sbGFibGVCb2R5VGFibGUsIHJlc2l6ZUNvbHVtbkluZGV4LCBuZXdDb2x1bW5XaWR0aCwgbnVsbCk7CiAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZUNvbEdyb3VwKHNjcm9sbGFibGVGb290ZXJUYWJsZSwgcmVzaXplQ29sdW1uSW5kZXgsIG5ld0NvbHVtbldpZHRoLCBudWxsKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgb25Sb3dNb3VzZURvd24oZXZlbnQpIHsKICAgICAgICAgICAgaWYgKERvbUhhbmRsZXIuaGFzQ2xhc3MoZXZlbnQudGFyZ2V0LCAncC1kYXRhdGFibGUtcmVvcmRlcmFibGVyb3ctaGFuZGxlJykpCiAgICAgICAgICAgICAgICBldmVudC5jdXJyZW50VGFyZ2V0LmRyYWdnYWJsZSA9IHRydWU7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuZHJhZ2dhYmxlID0gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBvblJvd0RyYWdTdGFydChlKSB7CiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gZS5vcmlnaW5hbEV2ZW50OwogICAgICAgICAgICBjb25zdCBpbmRleCA9IGUuaW5kZXg7CiAgICAgICAgICAgIHRoaXMucm93RHJhZ2dpbmcgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmRyYWdnZWRSb3dJbmRleCA9IGluZGV4OwogICAgICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YSgndGV4dCcsICdiJyk7ICAgIC8vIEZvciBmaXJlZm94CiAgICAgICAgfSwKICAgICAgICBvblJvd0RyYWdPdmVyKGUpIHsKICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBlLm9yaWdpbmFsRXZlbnQ7CiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZS5pbmRleDsKCiAgICAgICAgICAgIGlmICh0aGlzLnJvd0RyYWdnaW5nICYmIHRoaXMuZHJhZ2dlZFJvd0luZGV4ICE9PSBpbmRleCkgewogICAgICAgICAgICAgICAgbGV0IHJvd0VsZW1lbnQgPSBldmVudC5jdXJyZW50VGFyZ2V0OwogICAgICAgICAgICAgICAgbGV0IHJvd1kgPSBEb21IYW5kbGVyLmdldE9mZnNldChyb3dFbGVtZW50KS50b3AgKyBEb21IYW5kbGVyLmdldFdpbmRvd1Njcm9sbFRvcCgpOwogICAgICAgICAgICAgICAgbGV0IHBhZ2VZID0gZXZlbnQucGFnZVk7CiAgICAgICAgICAgICAgICBsZXQgcm93TWlkWSA9IHJvd1kgKyBEb21IYW5kbGVyLmdldE91dGVySGVpZ2h0KHJvd0VsZW1lbnQpIC8gMjsKICAgICAgICAgICAgICAgIGxldCBwcmV2Um93RWxlbWVudCA9IHJvd0VsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZzsKCiAgICAgICAgICAgICAgICBpZiAocGFnZVkgPCByb3dNaWRZKSB7CiAgICAgICAgICAgICAgICAgICAgRG9tSGFuZGxlci5yZW1vdmVDbGFzcyhyb3dFbGVtZW50LCAncC1kYXRhdGFibGUtZHJhZ3BvaW50LWJvdHRvbScpOwoKICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3BwZWRSb3dJbmRleCA9IGluZGV4OwogICAgICAgICAgICAgICAgICAgIGlmIChwcmV2Um93RWxlbWVudCkKICAgICAgICAgICAgICAgICAgICAgICAgRG9tSGFuZGxlci5hZGRDbGFzcyhwcmV2Um93RWxlbWVudCwgJ3AtZGF0YXRhYmxlLWRyYWdwb2ludC1ib3R0b20nKTsKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIERvbUhhbmRsZXIuYWRkQ2xhc3Mocm93RWxlbWVudCwgJ3AtZGF0YXRhYmxlLWRyYWdwb2ludC10b3AnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChwcmV2Um93RWxlbWVudCkKICAgICAgICAgICAgICAgICAgICAgICAgRG9tSGFuZGxlci5yZW1vdmVDbGFzcyhwcmV2Um93RWxlbWVudCwgJ3AtZGF0YXRhYmxlLWRyYWdwb2ludC1ib3R0b20nKTsKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIERvbUhhbmRsZXIuYWRkQ2xhc3Mocm93RWxlbWVudCwgJ3AtZGF0YXRhYmxlLWRyYWdwb2ludC10b3AnKTsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcm9wcGVkUm93SW5kZXggPSBpbmRleCArIDE7CiAgICAgICAgICAgICAgICAgICAgRG9tSGFuZGxlci5hZGRDbGFzcyhyb3dFbGVtZW50LCAncC1kYXRhdGFibGUtZHJhZ3BvaW50LWJvdHRvbScpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG9uUm93RHJhZ0xlYXZlKGV2ZW50KSB7CiAgICAgICAgICAgIGxldCByb3dFbGVtZW50ID0gZXZlbnQuY3VycmVudFRhcmdldDsKICAgICAgICAgICAgbGV0IHByZXZSb3dFbGVtZW50ID0gcm93RWxlbWVudC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nOwogICAgICAgICAgICBpZiAocHJldlJvd0VsZW1lbnQpIHsKICAgICAgICAgICAgICAgIERvbUhhbmRsZXIucmVtb3ZlQ2xhc3MocHJldlJvd0VsZW1lbnQsICdwLWRhdGF0YWJsZS1kcmFncG9pbnQtYm90dG9tJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIERvbUhhbmRsZXIucmVtb3ZlQ2xhc3Mocm93RWxlbWVudCwgJ3AtZGF0YXRhYmxlLWRyYWdwb2ludC1ib3R0b20nKTsKICAgICAgICAgICAgRG9tSGFuZGxlci5yZW1vdmVDbGFzcyhyb3dFbGVtZW50LCAncC1kYXRhdGFibGUtZHJhZ3BvaW50LXRvcCcpOwogICAgICAgIH0sCiAgICAgICAgb25Sb3dEcmFnRW5kKGV2ZW50KSB7CiAgICAgICAgICAgIHRoaXMucm93RHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5kcmFnZ2VkUm93SW5kZXggPSBudWxsOwogICAgICAgICAgICB0aGlzLmRyb3BwZWRSb3dJbmRleCA9IG51bGw7CiAgICAgICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuZHJhZ2dhYmxlID0gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBvblJvd0Ryb3AoZXZlbnQpIHsKICAgICAgICAgICAgaWYgKHRoaXMuZHJvcHBlZFJvd0luZGV4ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGxldCBkcm9wSW5kZXggPSAodGhpcy5kcmFnZ2VkUm93SW5kZXggPiB0aGlzLmRyb3BwZWRSb3dJbmRleCkgPyB0aGlzLmRyb3BwZWRSb3dJbmRleCA6ICh0aGlzLmRyb3BwZWRSb3dJbmRleCA9PT0gMCkgPyAwIDogdGhpcy5kcm9wcGVkUm93SW5kZXggLSAxOwogICAgICAgICAgICAgICAgbGV0IHByb2Nlc3NlZERhdGEgPSBbLi4udGhpcy5wcm9jZXNzZWREYXRhXTsKICAgICAgICAgICAgICAgIE9iamVjdFV0aWxzLnJlb3JkZXJBcnJheShwcm9jZXNzZWREYXRhLCB0aGlzLmRyYWdnZWRSb3dJbmRleCwgZHJvcEluZGV4KTsKCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdyb3ctcmVvcmRlcicsIHsKICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldmVudCwKICAgICAgICAgICAgICAgICAgICBkcmFnSW5kZXg6IHRoaXMuZHJhZ2dlZFJvd0luZGV4LAogICAgICAgICAgICAgICAgICAgIGRyb3BJbmRleDogZHJvcEluZGV4LAogICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwcm9jZXNzZWREYXRhCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9jbGVhbnVwCiAgICAgICAgICAgIHRoaXMub25Sb3dEcmFnTGVhdmUoZXZlbnQpOwogICAgICAgICAgICB0aGlzLm9uUm93RHJhZ0VuZChldmVudCk7CiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfSwKICAgICAgICB0b2dnbGVSb3coZXZlbnQpIHsKICAgICAgICAgICAgbGV0IHJvd0RhdGEgPSBldmVudC5kYXRhOwogICAgICAgICAgICBsZXQgZXhwYW5kZWQ7CiAgICAgICAgICAgIGxldCBleHBhbmRlZFJvd0luZGV4OwogICAgICAgICAgICBsZXQgX2V4cGFuZGVkUm93cyA9IHRoaXMuZXhwYW5kZWRSb3dzID8gWy4uLnRoaXMuZXhwYW5kZWRSb3dzXSA6IFtdOwoKICAgICAgICAgICAgaWYgKHRoaXMuZGF0YUtleSkgewogICAgICAgICAgICAgICAgZXhwYW5kZWQgPSB0aGlzLmRfZXhwYW5kZWRSb3dLZXlzID8gdGhpcy5kX2V4cGFuZGVkUm93S2V5c1tPYmplY3RVdGlscy5yZXNvbHZlRmllbGREYXRhKHJvd0RhdGEsIHRoaXMuZGF0YUtleSldICE9PSB1bmRlZmluZWQgOiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGV4cGFuZGVkUm93SW5kZXggPSB0aGlzLmZpbmRJbmRleChyb3dEYXRhLCB0aGlzLmV4cGFuZGVkUm93cyk7CiAgICAgICAgICAgICAgICBleHBhbmRlZCA9IGV4cGFuZGVkUm93SW5kZXggPiAtMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGV4cGFuZGVkKSB7CiAgICAgICAgICAgICAgICBpZiAoZXhwYW5kZWRSb3dJbmRleCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgZXhwYW5kZWRSb3dJbmRleCA9IHRoaXMuZmluZEluZGV4KHJvd0RhdGEsIHRoaXMuZXhwYW5kZWRSb3dzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9leHBhbmRlZFJvd3Muc3BsaWNlKGV4cGFuZGVkUm93SW5kZXgsIDEpOwogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOmV4cGFuZGVkUm93cycsIF9leHBhbmRlZFJvd3MpOwogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LWNvbGxhcHNlJywgZXZlbnQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgX2V4cGFuZGVkUm93cy5wdXNoKHJvd0RhdGEpOwogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOmV4cGFuZGVkUm93cycsIF9leHBhbmRlZFJvd3MpOwogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LWV4cGFuZCcsIGV2ZW50KTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgdG9nZ2xlUm93R3JvdXAoZSkgewogICAgICAgICAgICBjb25zdCBldmVudCA9IGUub3JpZ2luYWxFdmVudDsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGUuZGF0YTsKICAgICAgICAgICAgY29uc3QgZ3JvdXBGaWVsZFZhbHVlID0gT2JqZWN0VXRpbHMucmVzb2x2ZUZpZWxkRGF0YShkYXRhLCB0aGlzLmdyb3VwUm93c0J5KTsKICAgICAgICAgICAgbGV0IF9leHBhbmRlZFJvd0dyb3VwcyA9IHRoaXMuZXhwYW5kZWRSb3dHcm91cHMgPyBbLi4udGhpcy5leHBhbmRlZFJvd0dyb3Vwc10gOiBbXTsKCiAgICAgICAgICAgIGlmICh0aGlzLmlzUm93R3JvdXBFeHBhbmRlZChkYXRhKSkgewogICAgICAgICAgICAgICAgX2V4cGFuZGVkUm93R3JvdXBzID0gX2V4cGFuZGVkUm93R3JvdXBzLmZpbHRlcihncm91cCA9PiBncm91cCAhPT0gZ3JvdXBGaWVsZFZhbHVlKTsKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpleHBhbmRlZFJvd0dyb3VwcycsIF9leHBhbmRlZFJvd0dyb3Vwcyk7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdyb3dncm91cC1jb2xsYXBzZScsIHtvcmlnaW5hbEV2ZW50OiBldmVudCwgZGF0YTogZ3JvdXBGaWVsZFZhbHVlfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBfZXhwYW5kZWRSb3dHcm91cHMucHVzaChncm91cEZpZWxkVmFsdWUpOwogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOmV4cGFuZGVkUm93R3JvdXBzJywgX2V4cGFuZGVkUm93R3JvdXBzKTsKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3Jvd2dyb3VwLWV4cGFuZCcsIHtvcmlnaW5hbEV2ZW50OiBldmVudCwgZGF0YTogZ3JvdXBGaWVsZFZhbHVlfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGlzUm93R3JvdXBFeHBhbmRlZChyb3dEYXRhKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmV4cGFuZGFibGVSb3dHcm91cHMgJiYgdGhpcy5leHBhbmRlZFJvd0dyb3VwcykgewogICAgICAgICAgICAgICAgbGV0IGdyb3VwRmllbGRWYWx1ZSA9IE9iamVjdFV0aWxzLnJlc29sdmVGaWVsZERhdGEocm93RGF0YSwgdGhpcy5ncm91cFJvd3NCeSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5leHBhbmRlZFJvd0dyb3Vwcy5pbmRleE9mKGdyb3VwRmllbGRWYWx1ZSkgPiAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSwKICAgICAgICBpc1N0YXRlZnVsKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZUtleSAhPSBudWxsOwogICAgICAgIH0sCiAgICAgICAgZ2V0U3RvcmFnZSgpIHsKICAgICAgICAgICAgc3dpdGNoKHRoaXMuc3RhdGVTdG9yYWdlKSB7CiAgICAgICAgICAgICAgICBjYXNlICdsb2NhbCc6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2U7CgogICAgICAgICAgICAgICAgY2FzZSAnc2Vzc2lvbic6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5zZXNzaW9uU3RvcmFnZTsKCiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLnN0YXRlU3RvcmFnZSArICcgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIHRoZSBzdGF0ZSBzdG9yYWdlLCBzdXBwb3J0ZWQgdmFsdWVzIGFyZSAibG9jYWwiIGFuZCAic2Vzc2lvbiIuJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHNhdmVTdGF0ZSgpIHsKICAgICAgICAgICAgY29uc3Qgc3RvcmFnZSA9IHRoaXMuZ2V0U3RvcmFnZSgpOwogICAgICAgICAgICBsZXQgc3RhdGUgPSB7fTsKCiAgICAgICAgICAgIGlmICh0aGlzLnBhZ2luYXRvcikgewogICAgICAgICAgICAgICAgc3RhdGUuZmlyc3QgPSB0aGlzLmRfZmlyc3Q7CiAgICAgICAgICAgICAgICBzdGF0ZS5yb3dzID0gdGhpcy5kX3Jvd3M7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmRfc29ydEZpZWxkKSB7CiAgICAgICAgICAgICAgICBzdGF0ZS5zb3J0RmllbGQgPSB0aGlzLmRfc29ydEZpZWxkOwogICAgICAgICAgICAgICAgc3RhdGUuc29ydE9yZGVyID0gdGhpcy5kX3NvcnRPcmRlcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMuZF9tdWx0aVNvcnRNZXRhKSB7CiAgICAgICAgICAgICAgICBzdGF0ZS5tdWx0aVNvcnRNZXRhID0gdGhpcy5kX211bHRpU29ydE1ldGE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmhhc0ZpbHRlcnMoKSkgewogICAgICAgICAgICAgICAgc3RhdGUuZmlsdGVycyA9IHRoaXMuZmlsdGVyczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMucmVzaXphYmxlQ29sdW1ucykgewogICAgICAgICAgICAgICAgdGhpcy5zYXZlQ29sdW1uV2lkdGhzKHN0YXRlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMucmVvcmRlcmFibGVDb2x1bW5zKSB7CiAgICAgICAgICAgICAgICBzdGF0ZS5jb2x1bW5PcmRlciA9IHRoaXMuZF9jb2x1bW5PcmRlcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMuZXhwYW5kZWRSb3dzKSB7CiAgICAgICAgICAgICAgICBzdGF0ZS5leHBhbmRlZFJvd3MgPSB0aGlzLmV4cGFuZGVkUm93czsKICAgICAgICAgICAgICAgIHN0YXRlLmV4cGFuZGVkUm93S2V5cyA9IHRoaXMuZF9leHBhbmRlZFJvd0tleXM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmV4cGFuZGVkUm93R3JvdXBzKSB7CiAgICAgICAgICAgICAgICBzdGF0ZS5leHBhbmRlZFJvd0dyb3VwcyA9IHRoaXMuZXhwYW5kZWRSb3dHcm91cHM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbikgewogICAgICAgICAgICAgICAgc3RhdGUuc2VsZWN0aW9uID0gdGhpcy5zZWxlY3Rpb247CiAgICAgICAgICAgICAgICBzdGF0ZS5zZWxlY3Rpb25LZXlzID0gdGhpcy5kX3NlbGVjdGlvbktleXM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhzdGF0ZSkubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBzdG9yYWdlLnNldEl0ZW0odGhpcy5zdGF0ZUtleSwgSlNPTi5zdHJpbmdpZnkoc3RhdGUpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy4kZW1pdCgnc3RhdGUtc2F2ZScsIHN0YXRlKTsKICAgICAgICB9LAogICAgICAgIHJlc3RvcmVTdGF0ZSgpIHsKICAgICAgICAgICAgY29uc3Qgc3RvcmFnZSA9IHRoaXMuZ2V0U3RvcmFnZSgpOwogICAgICAgICAgICBjb25zdCBzdGF0ZVN0cmluZyA9IHN0b3JhZ2UuZ2V0SXRlbSh0aGlzLnN0YXRlS2V5KTsKCiAgICAgICAgICAgIGlmIChzdGF0ZVN0cmluZykgewogICAgICAgICAgICAgICAgbGV0IHJlc3RvcmVkU3RhdGUgPSBKU09OLnBhcnNlKHN0YXRlU3RyaW5nKTsKCiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYWdpbmF0b3IpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRfZmlyc3QgPSByZXN0b3JlZFN0YXRlLmZpcnN0OwogICAgICAgICAgICAgICAgICAgIHRoaXMuZF9yb3dzID0gcmVzdG9yZWRTdGF0ZS5yb3dzOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChyZXN0b3JlZFN0YXRlLnNvcnRGaWVsZCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZF9zb3J0RmllbGQgPSByZXN0b3JlZFN0YXRlLnNvcnRGaWVsZDsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRfc29ydE9yZGVyID0gcmVzdG9yZWRTdGF0ZS5zb3J0T3JkZXI7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHJlc3RvcmVkU3RhdGUubXVsdGlTb3J0TWV0YSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZF9tdWx0aVNvcnRNZXRhID0gcmVzdG9yZWRTdGF0ZS5tdWx0aVNvcnRNZXRhOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChyZXN0b3JlZFN0YXRlLmZpbHRlcnMpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6ZmlsdGVycycsIHJlc3RvcmVkU3RhdGUuZmlsdGVycyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzaXphYmxlQ29sdW1ucykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uV2lkdGhzU3RhdGUgPSByZXN0b3JlZFN0YXRlLmNvbHVtbldpZHRoczsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRhYmxlV2lkdGhTdGF0ZSA9IHJlc3RvcmVkU3RhdGUudGFibGVXaWR0aDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZW9yZGVyYWJsZUNvbHVtbnMpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRfY29sdW1uT3JkZXIgPSByZXN0b3JlZFN0YXRlLmNvbHVtbk9yZGVyOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChyZXN0b3JlZFN0YXRlLmV4cGFuZGVkUm93cykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZF9leHBhbmRlZFJvd0tleXMgPSByZXN0b3JlZFN0YXRlLmV4cGFuZGVkUm93S2V5czsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6ZXhwYW5kZWRSb3dzJywgcmVzdG9yZWRTdGF0ZS5leHBhbmRlZFJvd3MpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChyZXN0b3JlZFN0YXRlLmV4cGFuZGVkUm93R3JvdXBzKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOmV4cGFuZGVkUm93R3JvdXBzJywgcmVzdG9yZWRTdGF0ZS5leHBhbmRlZFJvd0dyb3Vwcyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHJlc3RvcmVkU3RhdGUuc2VsZWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kX3NlbGVjdGlvbktleXMgPSByZXN0b3JlZFN0YXRlLmRfc2VsZWN0aW9uS2V5czsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6c2VsZWN0aW9uJywgcmVzdG9yZWRTdGF0ZS5zZWxlY3Rpb24pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3N0YXRlLXJlc3RvcmUnLCByZXN0b3JlZFN0YXRlKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgc2F2ZUNvbHVtbldpZHRocyhzdGF0ZSkgewogICAgICAgICAgICBsZXQgd2lkdGhzID0gW107CiAgICAgICAgICAgIGxldCBoZWFkZXJzID0gRG9tSGFuZGxlci5maW5kKHRoaXMuJGVsLCAnLnAtZGF0YXRhYmxlLXRoZWFkID4gdHIgPiB0aCcpOwogICAgICAgICAgICBoZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHdpZHRocy5wdXNoKERvbUhhbmRsZXIuZ2V0T3V0ZXJXaWR0aChoZWFkZXIpKSk7CiAgICAgICAgICAgIHN0YXRlLmNvbHVtbldpZHRocyA9IHdpZHRocy5qb2luKCcsJyk7CgogICAgICAgICAgICBpZiAodGhpcy5jb2x1bW5SZXNpemVNb2RlID09PSAnZXhwYW5kJykgewogICAgICAgICAgICAgICAgc3RhdGUudGFibGVXaWR0aCA9IHRoaXMuc2Nyb2xsYWJsZSA/IERvbUhhbmRsZXIuZmluZFNpbmdsZSh0aGlzLiRlbCwgJy5wLWRhdGF0YWJsZS1zY3JvbGxhYmxlLWhlYWRlci10YWJsZScpLnN0eWxlLndpZHRoIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERvbUhhbmRsZXIuZ2V0T3V0ZXJXaWR0aCh0aGlzLiRyZWZzLnRhYmxlKSArICdweCc7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJlc3RvcmVDb2x1bW5XaWR0aHMoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmNvbHVtbldpZHRoc1N0YXRlKSB7CiAgICAgICAgICAgICAgICBsZXQgd2lkdGhzID0gdGhpcy5jb2x1bW5XaWR0aHNTdGF0ZS5zcGxpdCgnLCcpOwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbHVtblJlc2l6ZU1vZGUgPT09ICdleHBhbmQnICYmIHRoaXMudGFibGVXaWR0aFN0YXRlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsYWJsZSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZVNjcm9sbGFibGVUYWJsZShudWxsLCB0aGlzLnRhYmxlV2lkdGhTdGF0ZSwgMCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnRhYmxlLnN0eWxlLndpZHRoID0gdGhpcy50YWJsZVdpZHRoU3RhdGU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVsLnN0eWxlLndpZHRoID0gdGhpcy50YWJsZVdpZHRoU3RhdGU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbGFibGUpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgaGVhZGVyQ29scyA9IERvbUhhbmRsZXIuZmluZCh0aGlzLiRlbCwgJy5wLWRhdGF0YWJsZS1zY3JvbGxhYmxlLWhlYWRlci10YWJsZSA+IGNvbGdyb3VwID4gY29sJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGJvZHlDb2xzID0gRG9tSGFuZGxlci5maW5kKHRoaXMuJGVsLCAnLnAtZGF0YXRhYmxlLXNjcm9sbGFibGUtYm9keS10YWJsZSA+IGNvbGdyb3VwID4gY29sJyk7CgogICAgICAgICAgICAgICAgICAgIGhlYWRlckNvbHMuZm9yRWFjaCgoY29sLCBpbmRleCkgPT4gY29sLnN0eWxlLndpZHRoID0gd2lkdGhzW2luZGV4XSArICdweCcpOwogICAgICAgICAgICAgICAgICAgIGJvZHlDb2xzLmZvckVhY2goKGNvbCwgaW5kZXgpID0+IGNvbC5zdHlsZS53aWR0aCA9IHdpZHRoc1tpbmRleF0gKyAncHgnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGxldCBoZWFkZXJzID0gRG9tSGFuZGxlci5maW5kKHRoaXMuJHJlZnMudGFibGUsICcucC1kYXRhdGFibGUtdGhlYWQgPiB0ciA+IHRoJyk7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5mb3JFYWNoKChoZWFkZXIsIGluZGV4KSA9PiBoZWFkZXIuc3R5bGUud2lkdGggPSB3aWR0aHNbaW5kZXhdICsgJ3B4Jyk7CiAgICAgICAgICAgICAgICB9CgoKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgb25DZWxsRWRpdEluaXQoZXZlbnQpIHsKICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2VsbC1lZGl0LWluaXQnLCBldmVudCk7CiAgICAgICAgfSwKICAgICAgICBvbkNlbGxFZGl0Q29tcGxldGUoZXZlbnQpIHsKICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2VsbC1lZGl0LWNvbXBsZXRlJywgZXZlbnQpOwogICAgICAgIH0sCiAgICAgICAgb25DZWxsRWRpdENhbmNlbChldmVudCkgewogICAgICAgICAgICB0aGlzLiRlbWl0KCdjZWxsLWVkaXQtY2FuY2VsJywgZXZlbnQpOwogICAgICAgIH0sCiAgICAgICAgb25Sb3dFZGl0SW5pdChldmVudCkgewogICAgICAgICAgICBsZXQgX2VkaXRpbmdSb3dzID0gdGhpcy5lZGl0aW5nUm93cyA/IFsuLi50aGlzLmVkaXRpbmdSb3dzXSA6IFtdOwogICAgICAgICAgICBfZWRpdGluZ1Jvd3MucHVzaChldmVudC5kYXRhKTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOmVkaXRpbmdSb3dzJywgX2VkaXRpbmdSb3dzKTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LWVkaXQtaW5pdCcsIGV2ZW50KTsKICAgICAgICB9LAogICAgICAgIG9uUm93RWRpdFNhdmUoZXZlbnQpIHsKICAgICAgICAgICAgbGV0IF9lZGl0aW5nUm93cyA9IFsuLi50aGlzLmVkaXRpbmdSb3dzXTsKICAgICAgICAgICAgX2VkaXRpbmdSb3dzLnNwbGljZSh0aGlzLmZpbmRJbmRleChldmVudC5kYXRhLCBfZWRpdGluZ1Jvd3MpLCAxKTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOmVkaXRpbmdSb3dzJywgX2VkaXRpbmdSb3dzKTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgncm93LWVkaXQtc2F2ZScsIGV2ZW50KTsKICAgICAgICB9LAogICAgICAgIG9uUm93RWRpdENhbmNlbChldmVudCkgewogICAgICAgICAgICBsZXQgX2VkaXRpbmdSb3dzID0gWy4uLnRoaXMuZWRpdGluZ1Jvd3NdOwogICAgICAgICAgICBfZWRpdGluZ1Jvd3Muc3BsaWNlKHRoaXMuZmluZEluZGV4KGV2ZW50LmRhdGEsIF9lZGl0aW5nUm93cyksIDEpOwogICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6ZWRpdGluZ1Jvd3MnLCBfZWRpdGluZ1Jvd3MpOwogICAgICAgICAgICB0aGlzLiRlbWl0KCdyb3ctZWRpdC1jYW5jZWwnLCBldmVudCk7CiAgICAgICAgfSwKICAgICAgICBvblZpcnR1YWxTY3JvbGwoZXZlbnQpIHsKICAgICAgICAgICAgaWYodGhpcy52aXJ0dWFsU2Nyb2xsVGltZXIpIHsKICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnZpcnR1YWxTY3JvbGxUaW1lcik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMudmlydHVhbFNjcm9sbFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd2aXJ0dWFsLXNjcm9sbCcsIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3Q6IChldmVudC5wYWdlIC0gMSkgKiB0aGlzLnJvd3MsCiAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M6IHRoaXMucm93cyAqIDIKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0sIHRoaXMudmlydHVhbFNjcm9sbERlbGF5KTsKICAgICAgICB9LAogICAgICAgIGNyZWF0ZUxhenlMb2FkRXZlbnQoZXZlbnQpIHsKICAgICAgICAgICAgbGV0IGZpbHRlck1hdGNoTW9kZXM7CiAgICAgICAgICAgIGlmICh0aGlzLmhhc0ZpbHRlcnMoKSkgewogICAgICAgICAgICAgICAgZmlsdGVyTWF0Y2hNb2RlcyA9IHt9OwogICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5zLmZvckVhY2goY29sID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoY29sLmZpZWxkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlck1hdGNoTW9kZXNbY29sLmZpZWxkXSA9IGNvbC5maWx0ZXJNYXRjaE1vZGU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldmVudCwKICAgICAgICAgICAgICAgIGZpcnN0OiB0aGlzLmRfZmlyc3QsCiAgICAgICAgICAgICAgICByb3dzOiB0aGlzLmRfcm93cywKICAgICAgICAgICAgICAgIHNvcnRGaWVsZDogdGhpcy5kX3NvcnRGaWVsZCwKICAgICAgICAgICAgICAgIHNvcnRPcmRlcjogdGhpcy5kX3NvcnRPcmRlciwKICAgICAgICAgICAgICAgIG11bHRpU29ydE1ldGE6IHRoaXMuZF9tdWx0aVNvcnRNZXRhLAogICAgICAgICAgICAgICAgZmlsdGVyczogdGhpcy5maWx0ZXJzLAogICAgICAgICAgICAgICAgZmlsdGVyTWF0Y2hNb2RlczogZmlsdGVyTWF0Y2hNb2RlcwogICAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgaGFzRmlsdGVycygpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVycyAmJiBPYmplY3Qua2V5cyh0aGlzLmZpbHRlcnMpLmxlbmd0aCA+IDAgJiYgdGhpcy5maWx0ZXJzLmNvbnN0cnVjdG9yID09PSBPYmplY3Q7CiAgICAgICAgfSwKICAgICAgICBoYXNHbG9iYWxGaWx0ZXIoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlcnMgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuZmlsdGVycywgJ2dsb2JhbCcpOwogICAgICAgIH0sCiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICBjb250YWluZXJDbGFzcygpIHsKICAgICAgICAgICAgcmV0dXJuIFsKICAgICAgICAgICAgICAgICdwLWRhdGF0YWJsZSBwLWNvbXBvbmVudCcsIHsKICAgICAgICAgICAgICAgICAgICAncC1kYXRhdGFibGUtaG92ZXJhYmxlLXJvd3MnOiAodGhpcy5yb3dIb3ZlciB8fCB0aGlzLnNlbGVjdGlvbk1vZGUpLAogICAgICAgICAgICAgICAgICAgICdwLWRhdGF0YWJsZS1hdXRvLWxheW91dCc6IHRoaXMuYXV0b0xheW91dCwKICAgICAgICAgICAgICAgICAgICAncC1kYXRhdGFibGUtcmVzaXphYmxlJzogdGhpcy5yZXNpemFibGVDb2x1bW5zLAogICAgICAgICAgICAgICAgICAgICdwLWRhdGF0YWJsZS1yZXNpemFibGUtZml0JzogdGhpcy5yZXNpemFibGVDb2x1bW5zICYmIHRoaXMuY29sdW1uUmVzaXplTW9kZSA9PT0gJ2ZpdCcsCiAgICAgICAgICAgICAgICAgICAgJ3AtZGF0YXRhYmxlLXNjcm9sbGFibGUnOiB0aGlzLnNjcm9sbGFibGUsCiAgICAgICAgICAgICAgICAgICAgJ3AtZGF0YXRhYmxlLXZpcnR1YWwtc2Nyb2xsYWJsZSc6IHRoaXMudmlydHVhbFNjcm9sbCwKICAgICAgICAgICAgICAgICAgICAncC1kYXRhdGFibGUtZmxleC1zY3JvbGxhYmxlJzogKHRoaXMuc2Nyb2xsYWJsZSAmJiB0aGlzLnNjcm9sbEhlaWdodCA9PT0gJ2ZsZXgnKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdOwogICAgICAgIH0sCiAgICAgICAgY29sdW1ucygpIHsKICAgICAgICAgICAgbGV0IGNvbHVtbnMgPSBbXTsKCiAgICAgICAgICAgIGlmICh0aGlzLmFsbENoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICBjb2x1bW5zID0gdGhpcy5hbGxDaGlsZHJlbi5maWx0ZXIoY2hpbGQgPT4gY2hpbGQuJG9wdGlvbnMuX3Byb3BLZXlzLmluZGV4T2YoJ2NvbHVtbktleScpICE9PSAtMSk7CgogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVvcmRlcmFibGVDb2x1bW5zICYmIHRoaXMuZF9jb2x1bW5PcmRlcikgewogICAgICAgICAgICAgICAgICAgIGxldCBvcmRlcmVkQ29sdW1ucyA9IFtdOwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGNvbHVtbktleSBvZiB0aGlzLmRfY29sdW1uT3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbHVtbiA9IHRoaXMuZmluZENvbHVtbkJ5S2V5KGNvbHVtbnMsIGNvbHVtbktleSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2x1bW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyZWRDb2x1bW5zLnB1c2goY29sdW1uKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsuLi5vcmRlcmVkQ29sdW1ucywgLi4uY29sdW1ucy5maWx0ZXIoKGl0ZW0pID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yZGVyZWRDb2x1bW5zLmluZGV4T2YoaXRlbSkgPCAwOwogICAgICAgICAgICAgICAgICAgIH0pXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gY29sdW1uczsKICAgICAgICB9LAogICAgICAgIGZyb3plbkNvbHVtbnMoKSB7CiAgICAgICAgICAgIGxldCBmcm96ZW5Db2x1bW5zID0gW107CgogICAgICAgICAgICBmb3IobGV0IGNvbCBvZiB0aGlzLmNvbHVtbnMpIHsKICAgICAgICAgICAgICAgIGlmKGNvbC5mcm96ZW4pIHsKICAgICAgICAgICAgICAgICAgICBmcm96ZW5Db2x1bW5zID0gZnJvemVuQ29sdW1uc3x8W107CiAgICAgICAgICAgICAgICAgICAgZnJvemVuQ29sdW1ucy5wdXNoKGNvbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBmcm96ZW5Db2x1bW5zOwogICAgICAgIH0sCiAgICAgICAgc2Nyb2xsYWJsZUNvbHVtbnMoKSB7CiAgICAgICAgICAgIGxldCBzY3JvbGxhYmxlQ29sdW1ucyA9IFtdOwoKICAgICAgICAgICAgZm9yKGxldCBjb2wgb2YgdGhpcy5jb2x1bW5zKSB7CiAgICAgICAgICAgICAgICBpZighY29sLmZyb3plbikgewogICAgICAgICAgICAgICAgICAgIHNjcm9sbGFibGVDb2x1bW5zID0gc2Nyb2xsYWJsZUNvbHVtbnN8fFtdOwogICAgICAgICAgICAgICAgICAgIHNjcm9sbGFibGVDb2x1bW5zLnB1c2goY29sKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHNjcm9sbGFibGVDb2x1bW5zOwogICAgICAgIH0sCiAgICAgICAgaGFzRnJvemVuQ29sdW1ucygpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnJvemVuQ29sdW1ucy5sZW5ndGggPiAwOwogICAgICAgIH0sCiAgICAgICAgaGVhZGVyQ29sdW1uR3JvdXAoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmFsbENoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiB0aGlzLmFsbENoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLiR2bm9kZS50YWcuaW5kZXhPZignY29sdW1uZ3JvdXAnKSAhPT0gLTEgJiYgY2hpbGQudHlwZSA9PT0gJ2hlYWRlcicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSwKICAgICAgICBmcm96ZW5IZWFkZXJDb2x1bW5Hcm91cCgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuYWxsQ2hpbGRyZW4pIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IGNoaWxkIG9mIHRoaXMuYWxsQ2hpbGRyZW4pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGQuJHZub2RlLnRhZy5pbmRleE9mKCdjb2x1bW5ncm91cCcpICE9PSAtMSAmJiBjaGlsZC50eXBlID09PSAnZnJvemVuaGVhZGVyJykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9LAogICAgICAgIGZvb3RlckNvbHVtbkdyb3VwKCkgewogICAgICAgICAgICBpZiAodGhpcy5hbGxDaGlsZHJlbikgewogICAgICAgICAgICAgICAgZm9yIChsZXQgY2hpbGQgb2YgdGhpcy5hbGxDaGlsZHJlbikgewogICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZC4kdm5vZGUudGFnLmluZGV4T2YoJ2NvbHVtbmdyb3VwJykgIT09IC0xICYmIGNoaWxkLnR5cGUgPT09ICdmb290ZXInKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0sCiAgICAgICAgZnJvemVuRm9vdGVyQ29sdW1uR3JvdXAoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmFsbENoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiB0aGlzLmFsbENoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLiR2bm9kZS50YWcuaW5kZXhPZignY29sdW1uZ3JvdXAnKSAhPT0gLTEgJiYgY2hpbGQudHlwZSA9PT0gJ2Zyb3plbmZvb3RlcicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSwKICAgICAgICBwcm9jZXNzZWREYXRhKCkgewogICAgICAgICAgICBpZiAodGhpcy5sYXp5KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB0aGlzLnZhbHVlOwoKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zb3J0ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5zb3J0TW9kZSA9PT0gJ3NpbmdsZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5zb3J0U2luZ2xlKGRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuc29ydE1vZGUgPT09ICdtdWx0aXBsZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5zb3J0TXVsdGlwbGUoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNGaWx0ZXJzKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZmlsdGVyKGRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZGF0YVRvUmVuZGVyKCkgewogICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5wcm9jZXNzZWREYXRhOwoKICAgICAgICAgICAgaWYgKGRhdGEgJiYgdGhpcy5wYWdpbmF0b3IpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0ID0gdGhpcy5sYXp5ID8gMCA6IHRoaXMuZF9maXJzdDsKICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLnNsaWNlKGZpcnN0LCBmaXJzdCArIHRoaXMuZF9yb3dzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBkYXRhOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB0b3RhbFJlY29yZHNMZW5ndGgoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmxhenkpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvdGFsUmVjb3JkczsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLnByb2Nlc3NlZERhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YSA/IGRhdGEubGVuZ3RoIDogMDsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZW1wdHkoKSB7CiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLnByb2Nlc3NlZERhdGE7CiAgICAgICAgICAgIHJldHVybiAoIWRhdGEgfHwgZGF0YS5sZW5ndGggPT09IDApOwogICAgICAgIH0sCiAgICAgICAgcGFnaW5hdG9yVG9wKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5wYWdpbmF0b3IgJiYgKHRoaXMucGFnaW5hdG9yUG9zaXRpb24gIT09ICdib3R0b20nIHx8IHRoaXMucGFnaW5hdG9yUG9zaXRpb24gPT09ICdib3RoJyk7CiAgICAgICAgfSwKICAgICAgICBwYWdpbmF0b3JCb3R0b20oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhZ2luYXRvciAmJiAodGhpcy5wYWdpbmF0b3JQb3NpdGlvbiAhPT0gJ3RvcCcgfHwgdGhpcy5wYWdpbmF0b3JQb3NpdGlvbiA9PT0gJ2JvdGgnKTsKICAgICAgICB9LAogICAgICAgIHNvcnRlZCgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZF9zb3J0RmllbGQgfHwgKHRoaXMuZF9tdWx0aVNvcnRNZXRhICYmIHRoaXMuZF9tdWx0aVNvcnRNZXRhLmxlbmd0aCA+IDApOwogICAgICAgIH0sCiAgICAgICAgbG9hZGluZ0ljb25DbGFzcygpIHsKICAgICAgICAgICAgcmV0dXJuIFsncC1kYXRhdGFibGUtbG9hZGluZy1pY29uIHBpLXNwaW4nLCB0aGlzLmxvYWRpbmdJY29uXTsKICAgICAgICB9LAogICAgICAgIGFsbFJvd3NTZWxlY3RlZCgpIHsKICAgICAgICAgICAgY29uc3QgdmFsID0gdGhpcy5wcm9jZXNzZWREYXRhOwogICAgICAgICAgICByZXR1cm4gKHZhbCAmJiB2YWwubGVuZ3RoID4gMCAmJiB0aGlzLnNlbGVjdGlvbiAmJiB0aGlzLnNlbGVjdGlvbi5sZW5ndGggPiAwICYmIHRoaXMuc2VsZWN0aW9uLmxlbmd0aCA9PT0gdmFsLmxlbmd0aCk7CiAgICAgICAgfQogICAgfSwKICAgIGNvbXBvbmVudHM6IHsKICAgICAgICAnRFRQYWdpbmF0b3InOiBQYWdpbmF0b3IsCiAgICAgICAgJ0RUU2Nyb2xsYWJsZVZpZXcnOiBTY3JvbGxhYmxlVmlldywKICAgICAgICAnRFRUYWJsZUhlYWRlcic6IFRhYmxlSGVhZGVyLAogICAgICAgICdEVFRhYmxlQm9keSc6IFRhYmxlQm9keSwKICAgICAgICAnRFRUYWJsZUZvb3Rlcic6IFRhYmxlRm9vdGVyLAogICAgfQp9Cg=="},{"version":3,"sources":["DataTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DataTable.vue","sourceRoot":"node_modules/primevue/datatable","sourcesContent":["<template>\n    <div :class=\"containerClass\">\n        <slot></slot>\n        <div class=\"p-datatable-loading-overlay p-component-overlay\" v-if=\"loading\">\n            <i :class=\"loadingIconClass\"></i>\n        </div>\n        <div class=\"p-datatable-header\" v-if=\"$scopedSlots.header\">\n            <slot name=\"header\"></slot>\n        </div>\n        <DTPaginator v-if=\"paginatorTop\" :rows=\"d_rows\" :first=\"d_first\" :totalRecords=\"totalRecordsLength\" :pageLinkSize=\"pageLinkSize\" :template=\"paginatorTemplate\" :rowsPerPageOptions=\"rowsPerPageOptions\"\n                :currentPageReportTemplate=\"currentPageReportTemplate\" class=\"p-paginator-top\" @page=\"onPage($event)\" :alwaysShow=\"alwaysShowPaginator\">\n            <template #left v-if=\"$scopedSlots.paginatorLeft\">\n                <slot name=\"paginatorLeft\"></slot>\n            </template>\n            <template #right v-if=\"$scopedSlots.paginatorRight\">\n                <slot name=\"paginatorRight\"></slot>\n            </template>\n        </DTPaginator>\n        <div class=\"p-datatable-wrapper\" v-if=\"!scrollable\">\n            <table ref=\"table\" role=\"grid\">\n                <DTTableHeader :columnGroup=\"headerColumnGroup\" :columns=\"columns\" :rowGroupMode=\"rowGroupMode\"\n                        :groupRowsBy=\"groupRowsBy\" :resizableColumns=\"resizableColumns\" :allRowsSelected=\"allRowsSelected\" :empty=\"empty\"\n                        :sortMode=\"sortMode\" :sortField=\"d_sortField\" :sortOrder=\"d_sortOrder\" :multiSortMeta=\"d_multiSortMeta\"\n                        @column-click=\"onColumnHeaderClick($event)\" @column-mousedown=\"onColumnHeaderMouseDown($event)\"\n                        @column-dragstart=\"onColumnHeaderDragStart($event)\" @column-dragover=\"onColumnHeaderDragOver($event)\" @column-dragleave=\"onColumnHeaderDragLeave($event)\" @column-drop=\"onColumnHeaderDrop($event)\"\n                        @column-resizestart=\"onColumnResizeStart($event)\" @checkbox-change=\"toggleRowsWithCheckbox($event)\" />\n                <DTTableBody :value=\"dataToRender\" :columns=\"columns\" :empty=\"empty\" :dataKey=\"dataKey\" :selection=\"selection\" :selectionKeys=\"d_selectionKeys\" :selectionMode=\"selectionMode\" :contextMenu=\"contextMenu\" :contextMenuSelection=\"contextMenuSelection\"\n                    :rowGroupMode=\"rowGroupMode\" :groupRowsBy=\"groupRowsBy\" :expandableRowGroups=\"expandableRowGroups\" :rowClass=\"rowClass\" :editMode=\"editMode\" :compareSelectionBy=\"compareSelectionBy\"\n                    :expandedRowIcon=\"expandedRowIcon\" :collapsedRowIcon=\"collapsedRowIcon\" :expandedRows=\"expandedRows\" :expandedRowKeys=\"d_expandedRowKeys\" :expandedRowGroups=\"expandedRowGroups\"\n                    :editingRows=\"editingRows\" :editingRowKeys=\"d_editingRowKeys\" :templates=\"$scopedSlots\" :loading=\"loading\"\n                    @rowgroup-toggle=\"toggleRowGroup\" @row-click=\"onRowClick($event)\" @row-rightclick=\"onRowRightClick($event)\" @row-touchend=\"onRowTouchEnd\" @row-keydown=\"onRowKeyDown\"\n                    @row-mousedown=\"onRowMouseDown\" @row-dragstart=\"onRowDragStart($event)\" @row-dragover=\"onRowDragOver($event)\" @row-dragleave=\"onRowDragLeave($event)\" @row-dragend=\"onRowDragEnd($event)\" @row-drop=\"onRowDrop($event)\"\n                    @row-toggle=\"toggleRow($event)\" @radio-change=\"toggleRowWithRadio($event)\" @checkbox-change=\"toggleRowWithCheckbox($event)\"\n                    @cell-edit-init=\"onCellEditInit($event)\" @cell-edit-complete=\"onCellEditComplete($event)\" @cell-edit-cancel=\"onCellEditCancel($event)\"\n                    @row-edit-init=\"onRowEditInit($event)\" @row-edit-save=\"onRowEditSave($event)\" @row-edit-cancel=\"onRowEditCancel($event)\"/>\n                <DTTableFooter :columnGroup=\"footerColumnGroup\" :columns=\"columns\" />\n            </table>\n        </div>\n        <div class=\"p-datatable-scrollable-wrapper\" v-else>\n            <DTScrollableView v-if=\"hasFrozenColumns\" :scrollHeight=\"scrollHeight\" :columns=\"frozenColumns\" :frozenWidth=\"frozenWidth\" :frozen=\"true\"\n                :rowGroupMode=\"rowGroupMode\" :groupRowsBy=\"groupRowsBy\">\n                <template #header>\n                    <DTTableHeader :columnGroup=\"frozenHeaderColumnGroup\" :columns=\"frozenColumns\" :rowGroupMode=\"rowGroupMode\"\n                        :groupRowsBy=\"groupRowsBy\" :resizableColumns=\"resizableColumns\" :allRowsSelected=\"allRowsSelected\" :empty=\"empty\"\n                        :sortMode=\"sortMode\" :sortField=\"d_sortField\" :sortOrder=\"d_sortOrder\" :multiSortMeta=\"d_multiSortMeta\"\n                        @column-click=\"onColumnHeaderClick($event)\" @column-mousedown=\"onColumnHeaderMouseDown($event)\"\n                        @column-dragstart=\"onColumnHeaderDragStart($event)\" @column-dragover=\"onColumnHeaderDragOver($event)\" @column-dragleave=\"onColumnHeaderDragLeave($event)\" @column-drop=\"onColumnHeaderDrop($event)\"\n                        @column-resizestart=\"onColumnResizeStart($event)\" @checkbox-change=\"toggleRowsWithCheckbox($event)\" />\n                </template>\n                <template #body>\n                    <DTTableBody :value=\"dataToRender\" :columns=\"frozenColumns\" :empty=\"empty\" :dataKey=\"dataKey\" :selection=\"selection\" :selectionKeys=\"d_selectionKeys\" :selectionMode=\"selectionMode\" :contextMenu=\"contextMenu\" :contextMenuSelection=\"contextMenuSelection\"\n                        :rowGroupMode=\"rowGroupMode\" :groupRowsBy=\"groupRowsBy\" :expandableRowGroups=\"expandableRowGroups\" :rowClass=\"rowClass\" :editMode=\"editMode\" :compareSelectionBy=\"compareSelectionBy\"\n                        :expandedRowIcon=\"expandedRowIcon\" :collapsedRowIcon=\"collapsedRowIcon\" :expandedRows=\"expandedRows\" :expandedRowKeys=\"d_expandedRowKeys\" :expandedRowGroups=\"expandedRowGroups\"\n                        :editingRows=\"editingRows\" :editingRowKeys=\"d_editingRowKeys\" :templates=\"$scopedSlots\" :loading=\"loading\"\n                        @rowgroup-toggle=\"toggleRowGroup\" @row-click=\"onRowClick($event)\" @row-rightclick=\"onRowRightClick($event)\" @row-touchend=\"onRowTouchEnd\" @row-keydown=\"onRowKeyDown\"\n                        @row-mousedown=\"onRowMouseDown\" @row-dragstart=\"onRowDragStart($event)\" @row-dragover=\"onRowDragOver($event)\" @row-dragleave=\"onRowDragLeave($event)\" @row-dragend=\"onRowDragEnd($event)\" @row-drop=\"onRowDrop($event)\"\n                        @row-toggle=\"toggleRow($event)\" @radio-change=\"toggleRowWithRadio($event)\" @checkbox-change=\"toggleRowWithCheckbox($event)\"\n                        @cell-edit-init=\"onCellEditInit($event)\" @cell-edit-complete=\"onCellEditComplete($event)\" @cell-edit-cancel=\"onCellEditCancel($event)\"\n                        @row-edit-init=\"onRowEditInit($event)\" @row-edit-save=\"onRowEditSave($event)\" @row-edit-cancel=\"onRowEditCancel($event)\"/>\n                </template>\n                <template #frozenbody>\n                    <DTTableBody v-if=\"frozenValue\" :value=\"frozenValue\" :columns=\"frozenColumns\" :dataKey=\"dataKey\" :selection=\"selection\" :selectionKeys=\"d_selectionKeys\" :selectionMode=\"selectionMode\" :contextMenu=\"contextMenu\" :contextMenuSelection=\"contextMenuSelection\"\n                        :rowGroupMode=\"rowGroupMode\" :groupRowsBy=\"groupRowsBy\" :expandableRowGroups=\"expandableRowGroups\" :rowClass=\"rowClass\" :editMode=\"editMode\" :compareSelectionBy=\"compareSelectionBy\"\n                        :expandedRowIcon=\"expandedRowIcon\" :collapsedRowIcon=\"collapsedRowIcon\" :expandedRows=\"expandedRows\" :expandedRowKeys=\"d_expandedRowKeys\" :expandedRowGroups=\"expandedRowGroups\"\n                        :editingRows=\"editingRows\" :editingRowKeys=\"d_editingRowKeys\" :templates=\"$scopedSlots\" :loading=\"loading\"\n                        @rowgroup-toggle=\"toggleRowGroup\" @row-click=\"onRowClick($event)\" @row-rightclick=\"onRowRightClick($event)\" @row-touchend=\"onRowTouchEnd\" @row-keydown=\"onRowKeyDown\"\n                        @row-mousedown=\"onRowMouseDown\" @row-dragstart=\"onRowDragStart($event)\" @row-dragover=\"onRowDragOver($event)\" @row-dragleave=\"onRowDragLeave($event)\" @row-dragend=\"onRowDragEnd($event)\" @row-drop=\"onRowDrop($event)\"\n                        @row-toggle=\"toggleRow($event)\" @radio-change=\"toggleRowWithRadio($event)\" @checkbox-change=\"toggleRowWithCheckbox($event)\"\n                        @cell-edit-init=\"onCellEditInit($event)\" @cell-edit-complete=\"onCellEditComplete($event)\" @cell-edit-cancel=\"onCellEditCancel($event)\"\n                        @row-edit-init=\"onRowEditInit($event)\" @row-edit-save=\"onRowEditSave($event)\" @row-edit-cancel=\"onRowEditCancel($event)\"/>\n                </template>\n                <template #footer>\n                    <DTTableFooter :columnGroup=\"frozenFooterColumnGroup\" :columns=\"frozenColumns\" />\n                </template>\n            </DTScrollableView>\n            <DTScrollableView :scrollHeight=\"scrollHeight\" :columns=\"scrollableColumns\" :frozenWidth=\"frozenWidth\" :rows=\"rows\"\n                :virtualScroll=\"virtualScroll\" :virtualRowHeight=\"virtualRowHeight\" :totalRecords=\"totalRecordsLength\" @virtual-scroll=\"onVirtualScroll\"\n                :rowGroupMode=\"rowGroupMode\" :groupRowsBy=\"groupRowsBy\">\n                <template #header>\n                    <DTTableHeader :columnGroup=\"headerColumnGroup\" :columns=\"scrollableColumns\" :rowGroupMode=\"rowGroupMode\"\n                        :groupRowsBy=\"groupRowsBy\" :resizableColumns=\"resizableColumns\" :allRowsSelected=\"allRowsSelected\" :empty=\"empty\"\n                        :sortMode=\"sortMode\" :sortField=\"d_sortField\" :sortOrder=\"d_sortOrder\" :multiSortMeta=\"d_multiSortMeta\"\n                        @column-click=\"onColumnHeaderClick($event)\" @column-mousedown=\"onColumnHeaderMouseDown($event)\"\n                        @column-dragstart=\"onColumnHeaderDragStart($event)\" @column-dragover=\"onColumnHeaderDragOver($event)\" @column-dragleave=\"onColumnHeaderDragLeave($event)\" @column-drop=\"onColumnHeaderDrop($event)\"\n                        @column-resizestart=\"onColumnResizeStart($event)\" @checkbox-change=\"toggleRowsWithCheckbox($event)\" />\n                </template>\n                <template #body>\n                    <DTTableBody :value=\"dataToRender\" :columns=\"scrollableColumns\" :empty=\"empty\" :dataKey=\"dataKey\" :selection=\"selection\" :selectionKeys=\"d_selectionKeys\" :selectionMode=\"selectionMode\" :contextMenu=\"contextMenu\" :contextMenuSelection=\"contextMenuSelection\"\n                        :rowGroupMode=\"rowGroupMode\" :groupRowsBy=\"groupRowsBy\" :expandableRowGroups=\"expandableRowGroups\" :rowClass=\"rowClass\" :editMode=\"editMode\" :compareSelectionBy=\"compareSelectionBy\"\n                        :expandedRowIcon=\"expandedRowIcon\" :collapsedRowIcon=\"collapsedRowIcon\" :expandedRows=\"expandedRows\" :expandedRowKeys=\"d_expandedRowKeys\" :expandedRowGroups=\"expandedRowGroups\"\n                        :editingRows=\"editingRows\" :editingRowKeys=\"d_editingRowKeys\" :templates=\"$scopedSlots\" :loading=\"loading\"\n                        @rowgroup-toggle=\"toggleRowGroup\" @row-click=\"onRowClick($event)\" @row-rightclick=\"onRowRightClick($event)\" @row-touchend=\"onRowTouchEnd\" @row-keydown=\"onRowKeyDown\"\n                        @row-mousedown=\"onRowMouseDown\" @row-dragstart=\"onRowDragStart($event)\" @row-dragover=\"onRowDragOver($event)\" @row-dragleave=\"onRowDragLeave($event)\" @row-dragend=\"onRowDragEnd($event)\" @row-drop=\"onRowDrop($event)\"\n                        @row-toggle=\"toggleRow($event)\" @radio-change=\"toggleRowWithRadio($event)\" @checkbox-change=\"toggleRowWithCheckbox($event)\"\n                        @cell-edit-init=\"onCellEditInit($event)\" @cell-edit-complete=\"onCellEditComplete($event)\" @cell-edit-cancel=\"onCellEditCancel($event)\"\n                        @row-edit-init=\"onRowEditInit($event)\" @row-edit-save=\"onRowEditSave($event)\" @row-edit-cancel=\"onRowEditCancel($event)\"/>\n                </template>\n                <template #frozenbody>\n                    <DTTableBody  v-if=\"frozenValue\" :value=\"frozenValue\" :columns=\"scrollableColumns\" :dataKey=\"dataKey\" :selection=\"selection\" :selectionKeys=\"d_selectionKeys\" :selectionMode=\"selectionMode\" :contextMenu=\"contextMenu\" :contextMenuSelection=\"contextMenuSelection\"\n                        :rowGroupMode=\"rowGroupMode\" :groupRowsBy=\"groupRowsBy\" :expandableRowGroups=\"expandableRowGroups\" :rowClass=\"rowClass\" :editMode=\"editMode\" :compareSelectionBy=\"compareSelectionBy\"\n                        :expandedRowIcon=\"expandedRowIcon\" :collapsedRowIcon=\"collapsedRowIcon\" :expandedRows=\"expandedRows\" :expandedRowKeys=\"d_expandedRowKeys\" :expandedRowGroups=\"expandedRowGroups\"\n                        :editingRows=\"editingRows\" :editingRowKeys=\"d_editingRowKeys\" :templates=\"$scopedSlots\" :loading=\"loading\"\n                        @rowgroup-toggle=\"toggleRowGroup\" @row-click=\"onRowClick($event)\" @row-rightclick=\"onRowRightClick($event)\" @row-touchend=\"onRowTouchEnd\" @row-keydown=\"onRowKeyDown\"\n                        @row-mousedown=\"onRowMouseDown\" @row-dragstart=\"onRowDragStart($event)\" @row-dragover=\"onRowDragOver($event)\" @row-dragleave=\"onRowDragLeave($event)\" @row-dragend=\"onRowDragEnd($event)\" @row-drop=\"onRowDrop($event)\"\n                        @row-toggle=\"toggleRow($event)\" @radio-change=\"toggleRowWithRadio($event)\" @checkbox-change=\"toggleRowWithCheckbox($event)\"\n                        @cell-edit-init=\"onCellEditInit($event)\" @cell-edit-complete=\"onCellEditComplete($event)\" @cell-edit-cancel=\"onCellEditCancel($event)\"\n                        @row-edit-init=\"onRowEditInit($event)\" @row-edit-save=\"onRowEditSave($event)\" @row-edit-cancel=\"onRowEditCancel($event)\"/>\n                </template>\n                <template #footer>\n                    <DTTableFooter :columnGroup=\"footerColumnGroup\" :columns=\"scrollableColumns\" />\n                </template>\n            </DTScrollableView>\n        </div>\n        <DTPaginator v-if=\"paginatorBottom\" :rows=\"d_rows\" :first=\"d_first\" :totalRecords=\"totalRecordsLength\" :pageLinkSize=\"pageLinkSize\" :template=\"paginatorTemplate\" :rowsPerPageOptions=\"rowsPerPageOptions\"\n                :currentPageReportTemplate=\"currentPageReportTemplate\" class=\"p-paginator-bottom\" @page=\"onPage($event)\" :alwaysShow=\"alwaysShowPaginator\">\n            <template #left v-if=\"$scopedSlots.paginatorLeft\">\n                <slot name=\"paginatorLeft\"></slot>\n            </template>\n            <template #right v-if=\"$scopedSlots.paginatorRight\">\n                <slot name=\"paginatorRight\"></slot>\n            </template>\n        </DTPaginator>\n        <div class=\"p-datatable-footer\" v-if=\"$scopedSlots.footer\">\n            <slot name=\"footer\"></slot>\n        </div>\n        <div ref=\"resizeHelper\" class=\"p-column-resizer-helper\" style=\"display: none\"></div>\n        <span ref=\"reorderIndicatorUp\" class=\"pi pi-arrow-down p-datatable-reorder-indicator-up\" style=\"position: absolute; display: none\" v-if=\"reorderableColumns\" />\n        <span ref=\"reorderIndicatorDown\" class=\"pi pi-arrow-up p-datatable-reorder-indicator-down\" style=\"position: absolute; display: none\" v-if=\"reorderableColumns\" />\n    </div>\n</template>\n\n<script>\nimport ObjectUtils from '../utils/ObjectUtils';\nimport FilterUtils from '../utils/FilterUtils';\nimport DomHandler from '../utils/DomHandler';\nimport Paginator from '../paginator/Paginator';\nimport ScrollableView from './ScrollableView.vue';\nimport TableHeader from './TableHeader.vue';\nimport TableBody from './TableBody.vue';\nimport TableFooter from './TableFooter.vue';\n\nexport default {\n    props: {\n        value: {\n            type: Array,\n            default: null\n        },\n        dataKey: {\n            type: String,\n            default: null\n        },\n        rows: {\n            type: Number,\n            default: 0\n        },\n        first: {\n            type: Number,\n            default: 0\n        },\n        totalRecords: {\n            type: Number,\n            default: 0\n        },\n        paginator: {\n            type: Boolean,\n            default: false\n        },\n        paginatorPosition: {\n            type: String,\n            default: 'bottom'\n        },\n        alwaysShowPaginator: {\n            type: Boolean,\n            default: true\n        },\n        paginatorTemplate: {\n            type: String,\n            default: 'FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown'\n        },\n        pageLinkSize: {\n            type: Number,\n            default: 5\n        },\n        rowsPerPageOptions: {\n            type: Array,\n            default: null\n        },\n        currentPageReportTemplate: {\n            type: String,\n            default: '({currentPage} of {totalPages})'\n        },\n        lazy: {\n            type: Boolean,\n            default: false\n        },\n        loading: {\n            type: Boolean,\n            default: false\n        },\n        loadingIcon: {\n            type: String,\n            default: 'pi pi-spinner'\n        },\n        sortField: {\n            type: [String, Function],\n            default: null\n        },\n        sortOrder: {\n            type: Number,\n            default: null\n        },\n        defaultSortOrder: {\n            type: Number,\n            default: 1\n        },\n        multiSortMeta: {\n            type: Array,\n            default: null\n        },\n        sortMode: {\n            type: String,\n            default: 'single'\n        },\n        removableSort: {\n            type: Boolean,\n            default: false\n        },\n        filters: {\n            type: Object,\n            default: null\n        },\n        filterLocale: {\n            type: String,\n            default: undefined\n        },\n        selection: {\n            type: [Array,Object],\n            default: null\n        },\n        selectionMode: {\n            type: String,\n            default: null\n        },\n        compareSelectionBy: {\n            type: String,\n            default: 'deepEquals'\n        },\n        metaKeySelection: {\n            type: Boolean,\n            default: true\n        },\n        contextMenu: {\n            type: Boolean,\n            default: false\n        },\n        contextMenuSelection: {\n            type: Object,\n            default: null\n        },\n        rowHover: {\n            type: Boolean,\n            default: false\n        },\n        csvSeparator: {\n            type: String,\n            default: ','\n        },\n        exportFilename: {\n            type: String,\n            default: 'download'\n        },\n        autoLayout: {\n            type: Boolean,\n            default: false\n        },\n        resizableColumns: {\n            type: Boolean,\n            default: false\n        },\n        columnResizeMode: {\n            type: String,\n            default: 'fit'\n        },\n        reorderableColumns: {\n            type: Boolean,\n            default: false\n        },\n        expandedRows: {\n            type: Array,\n            default: null\n        },\n        expandedRowIcon: {\n            type: String,\n            default: 'pi-chevron-down'\n        },\n        collapsedRowIcon: {\n            type: String,\n            default: 'pi-chevron-right'\n        },\n        rowGroupMode: {\n            type: String,\n            default: null\n        },\n        groupRowsBy: {\n            type: [Array,String],\n            default: null\n        },\n        expandableRowGroups: {\n            type: Boolean,\n            default: false\n        },\n        expandedRowGroups: {\n            type: Array,\n            default: null\n        },\n        stateStorage: {\n            type: String,\n            default: 'session'\n        },\n        stateKey: {\n            type: String,\n            default: null\n        },\n        editMode: {\n            type: String,\n            default: null\n        },\n        editingRows: {\n            type: Array,\n            default: null\n        },\n        rowClass: {\n            type: null,\n            default: null\n        },\n        scrollable: {\n            type: Boolean,\n            default: false\n        },\n        scrollHeight: {\n            type: String,\n            default: null\n        },\n        frozenValue: {\n            type: Array,\n            default: null\n        },\n        frozenWidth: {\n            type: String,\n            default: null\n        },\n        virtualScroll: {\n            type: Boolean,\n            default: false\n        },\n        virtualRowHeight: {\n            type: Number,\n            default: 28\n        },\n        virtualScrollDelay: {\n            type: Number,\n            default: 150\n        }\n    },\n    data() {\n        return {\n            allChildren: null,\n            d_first: this.first,\n            d_rows: this.rows,\n            d_sortField: this.sortField,\n            d_sortOrder: this.sortOrder,\n            d_multiSortMeta: this.multiSortMeta ? [...this.multiSortMeta] : [],\n            d_selectionKeys: null,\n            d_expandedRowKeys: null,\n            d_columnOrder: null,\n            d_editingRowKeys: null\n        };\n    },\n    rowTouched: false,\n    anchorRowIndex: null,\n    rangeRowIndex: null,\n    documentColumnResizeListener: null,\n    documentColumnResizeEndListener: null,\n    lastResizeHelperX: null,\n    resizeColumnElement: null,\n    columnResizing: false,\n    colReorderIconWidth: null,\n    colReorderIconHeight: null,\n    draggedColumn: null,\n    draggedRowIndex: null,\n    droppedRowIndex: null,\n    rowDragging: null,\n    columnWidthsState: null,\n    tableWidthState: null,\n    columnWidthsRestored: false,\n    virtualScrollTimer: null,\n    watch: {\n        first(newValue) {\n            this.d_first = newValue;\n        },\n        rows(newValue) {\n            this.d_rows = newValue;\n        },\n        sortField(newValue) {\n            this.d_sortField = newValue;\n        },\n        sortOrder(newValue) {\n            this.d_sortOrder = newValue;\n        },\n        multiSortMeta(newValue) {\n            this.d_multiSortMeta = newValue;\n        },\n        selection(newValue) {\n            if (this.dataKey) {\n                this.updateSelectionKeys(newValue);\n            }\n        },\n        expandedRows(newValue) {\n            if (this.dataKey) {\n                this.updateExpandedRowKeys(newValue);\n            }\n        },\n        editingRows(newValue) {\n            if (this.dataKey) {\n                this.updateEditingRowKeys(newValue);\n            }\n        }\n    },\n    beforeMount() {\n        if (this.isStateful()) {\n            this.restoreState();\n        }\n    },\n    mounted() {\n        this.allChildren = this.$children;\n\n        if (this.reorderableColumns) {\n            let columnOrder = [];\n            for (let child of this.allChildren) {\n                if (child.$options._propKeys.indexOf('columnKey') !== -1) {\n                    columnOrder.push(child.columnKey||child.field);\n                }\n            }\n            this.d_columnOrder = columnOrder;\n        }\n    },\n    beforeDestroy() {\n        this.unbindColumnResizeEvents();\n    },\n    updated() {\n        if (this.isStateful()) {\n            this.saveState();\n\n            if (this.resizableColumns && !this.columnWidthsRestored) {\n                this.restoreColumnWidths();\n                this.columnWidthsRestored = true;\n            }\n        }\n    },\n    methods: {\n        onPage(event) {\n            this.d_first = event.first;\n            this.d_rows = event.rows;\n\n            let pageEvent = this.createLazyLoadEvent(event);\n            pageEvent.pageCount = event.pageCount;\n            pageEvent.page = event.page;\n\n            this.$emit('update:first', this.d_first);\n            this.$emit('update:rows', this.d_rows);\n            this.$emit('page', pageEvent);\n        },\n        onColumnHeaderClick(e) {\n            const event = e.originalEvent;\n            const column = e.column;\n\n            if (column.sortable) {\n                const targetNode = event.target;\n                const columnField = column.sortField || column.field;\n\n                if (DomHandler.hasClass(targetNode, 'p-sortable-column') || DomHandler.hasClass(targetNode, 'p-column-title')\n                    || DomHandler.hasClass(targetNode, 'p-sortable-column-icon') || DomHandler.hasClass(targetNode.parentElement, 'p-sortable-column-icon')) {\n                    DomHandler.clearSelection();\n\n                    if (this.sortMode === 'single') {\n                        if (this.d_sortField === columnField) {\n                            if (this.removableSort && (this.d_sortOrder * -1 === this.defaultSortOrder)) {\n                                this.d_sortOrder = null;\n                                this.d_sortField = null;\n                            }\n                            else {\n                                this.d_sortOrder = this.d_sortOrder * -1;\n                            }\n                        }\n                        else {\n                            this.d_sortOrder = this.defaultSortOrder;\n                            this.d_sortField = columnField;\n                        }\n\n                        this.$emit('update:sortField', this.d_sortField);\n                        this.$emit('update:sortOrder', this.d_sortOrder);\n                        this.resetPage();\n                    }\n                    else if (this.sortMode === 'multiple') {\n                        let metaKey = event.metaKey || event.ctrlKey;\n                        if (!metaKey) {\n                            this.d_multiSortMeta =  this.d_multiSortMeta.filter(meta => meta.field === columnField);\n                        }\n\n                        this.addMultiSortField(columnField);\n                        this.$emit('update:multiSortMeta', this.d_multiSortMeta);\n                    }\n\n                    this.$emit('sort', this.createLazyLoadEvent(event));\n                }\n            }\n        },\n        sortSingle(value) {\n            let data = [...value];\n\n            data.sort((data1, data2) => {\n                let value1 = ObjectUtils.resolveFieldData(data1, this.d_sortField);\n                let value2 = ObjectUtils.resolveFieldData(data2, this.d_sortField);\n\n                let result = null;\n\n                if (value1 == null && value2 != null)\n                    result = -1;\n                else if (value1 != null && value2 == null)\n                    result = 1;\n                else if (value1 == null && value2 == null)\n                    result = 0;\n                else if (typeof value1 === 'string' && typeof value2 === 'string')\n                    result = value1.localeCompare(value2, undefined, { numeric: true });\n                else\n                    result = (value1 < value2) ? -1 : (value1 > value2) ? 1 : 0;\n\n                return (this.d_sortOrder * result);\n            });\n\n            return data;\n        },\n        sortMultiple(value) {\n            let data = [...value];\n\n            data.sort((data1, data2) => {\n                return this.multisortField(data1, data2, 0);\n            });\n\n            return data;\n        },\n        multisortField(data1, data2, index) {\n            const value1 = ObjectUtils.resolveFieldData(data1, this.d_multiSortMeta[index].field);\n            const value2 = ObjectUtils.resolveFieldData(data2, this.d_multiSortMeta[index].field);\n            let result = null;\n\n            if (typeof value1 === 'string' || value1 instanceof String) {\n                if (value1.localeCompare && (value1 !== value2)) {\n                    return (this.d_multiSortMeta[index].order * value1.localeCompare(value2, undefined, { numeric: true }));\n                }\n            }\n            else {\n                result = (value1 < value2) ? -1 : 1;\n            }\n\n            if (value1 === value2)  {\n                return (this.d_multiSortMeta.length - 1) > (index) ? (this.multisortField(data1, data2, index + 1)) : 0;\n            }\n\n            return (this.d_multiSortMeta[index].order * result);\n        },\n        addMultiSortField(field) {\n            let index =  this.d_multiSortMeta.findIndex(meta => meta.field === field);\n\n            if (index >= 0) {\n                if (this.removableSort && (this.d_multiSortMeta[index].order * -1 === this.defaultSortOrder))\n                    this.d_multiSortMeta.splice(index, 1);\n                else\n                    this.d_multiSortMeta[index] = {field: field, order: this.d_multiSortMeta[index].order * -1};\n            }\n            else {\n                this.d_multiSortMeta.push({field: field, order: this.defaultSortOrder});\n            }\n\n            this.d_multiSortMeta = [...this.d_multiSortMeta];\n        },\n        filter(data) {\n            this.d_first = 0;\n            this.$emit('update:first', this.d_first);\n\n            let filteredValue = [];\n\n            for(let i = 0; i < data.length; i++) {\n                let localMatch = true;\n                let globalMatch = false;\n\n                for(let j = 0; j < this.columns.length; j++) {\n                    let col = this.columns[j];\n                    let columnField = col.filterField || col.field;\n\n                    //local\n                    if (Object.prototype.hasOwnProperty.call(this.filters, columnField)) {\n                        let filterValue = this.filters[columnField];\n                        let dataFieldValue = ObjectUtils.resolveFieldData(data[i], columnField);\n                        let filterConstraint = col.filterMatchMode === 'custom' ? col.filterFunction : FilterUtils[col.filterMatchMode];\n                        if (!filterConstraint(dataFieldValue, filterValue, this.filterLocale)) {\n                            localMatch = false;\n                        }\n\n                        if (!localMatch) {\n                            break;\n                        }\n                    }\n\n                    if (!col.excludeGlobalFilter && this.hasGlobalFilter() && !globalMatch) {\n                        globalMatch = FilterUtils.contains(ObjectUtils.resolveFieldData(data[i], columnField), this.filters['global'], this.filterLocale);\n                    }\n                }\n\n                let matches = localMatch;\n                if(this.hasGlobalFilter()) {\n                    matches = localMatch && globalMatch;\n                }\n\n                if(matches) {\n                    filteredValue.push(data[i]);\n                }\n            }\n\n            if (filteredValue.length === data.length) {\n                filteredValue = data;\n            }\n\n            let filterEvent = this.createLazyLoadEvent();\n            filterEvent.filteredValue = filteredValue;\n            this.$emit('filter', filterEvent);\n\n            return filteredValue;\n        },\n        onRowClick(e) {\n            const event = e.originalEvent;\n            if (DomHandler.isClickable(event.target)) {\n                return;\n            }\n\n            this.$emit('row-click', e);\n\n            if (this.selectionMode) {\n                const rowData = e.data;\n                const rowIndex = e.index;\n\n                if (this.isMultipleSelectionMode() && event.shiftKey && this.anchorRowIndex != null) {\n                    DomHandler.clearSelection();\n                    this.rangeRowIndex = rowIndex;\n                    this.selectRange(event);\n                }\n                else {\n                    const selected = this.isSelected(rowData);\n                    const metaSelection = this.rowTouched ? false : this.metaKeySelection;\n                    this.anchorRowIndex = rowIndex;\n                    this.rangeRowIndex = rowIndex;\n\n                    if (metaSelection) {\n                        let metaKey = event.metaKey || event.ctrlKey;\n\n                        if (selected && metaKey) {\n                            if(this.isSingleSelectionMode()) {\n                                this.$emit('update:selection', null);\n                            }\n                            else {\n                                const selectionIndex = this.findIndexInSelection(rowData);\n                                const _selection = this.selection.filter((val,i) => i != selectionIndex);\n                                this.$emit('update:selection', _selection);\n                            }\n\n                            this.$emit('row-unselect', {originalEvent: event, data: rowData, index: event.index, type: 'row'});\n                        }\n                        else {\n                            if(this.isSingleSelectionMode()) {\n                                this.$emit('update:selection', rowData);\n                            }\n                            else if (this.isMultipleSelectionMode()) {\n                                let _selection = metaKey ? (this.selection || []) : [];\n                                _selection = [..._selection, rowData];\n                                this.$emit('update:selection', _selection);\n                            }\n\n                            this.$emit('row-select', {originalEvent: event, data: rowData, index: event.index, type: 'row'});\n                        }\n                    }\n                    else {\n                        if (this.selectionMode === 'single') {\n                            if (selected) {\n                                this.$emit('update:selection', null);\n                                this.$emit('row-unselect', {originalEvent: event, data: rowData, index: event.index, type: 'row'});\n                            }\n                            else {\n                                this.$emit('update:selection', rowData);\n                                this.$emit('row-select', {originalEvent: event, data: rowData, index: event.index, type: 'row'});\n                            }\n                        }\n                        else if (this.selectionMode === 'multiple') {\n                            if (selected) {\n                                const selectionIndex = this.findIndexInSelection(rowData);\n                                const _selection = this.selection.filter((val, i) => i != selectionIndex);\n                                this.$emit('update:selection', _selection);\n                                this.$emit('row-unselect', {originalEvent: event, data: rowData, index: event.index, type: 'row'});\n                            }\n                            else {\n                                const _selection = this.selection ? [...this.selection, rowData] : [rowData];\n                                this.$emit('update:selection', _selection);\n                                this.$emit('row-select', {originalEvent: event, data: rowData, index: event.index, type: 'row'});\n                            }\n                        }\n                    }\n                }\n            }\n\n            this.rowTouched = false;\n        },\n        onRowRightClick(event) {\n            DomHandler.clearSelection();\n            event.originalEvent.target.focus();\n\n            this.$emit('update:contextMenuSelection', event.data);\n            this.$emit('row-contextmenu', event);\n        },\n        onRowTouchEnd() {\n            this.rowTouched = true;\n        },\n        onRowKeyDown(e) {\n            const event = e.originalEvent;\n            const rowData = e.data;\n            const rowIndex = e.index;\n\n            if (this.selectionMode) {\n                const row = event.target;\n\n                switch (event.which) {\n                    //down arrow\n                    case 40:\n                        var nextRow = this.findNextSelectableRow(row);\n                        if (nextRow) {\n                            nextRow.focus();\n                        }\n\n                        event.preventDefault();\n                    break;\n\n                    //up arrow\n                    case 38:\n                        var prevRow = this.findPrevSelectableRow(row);\n                        if (prevRow) {\n                            prevRow.focus();\n                        }\n\n                        event.preventDefault();\n                    break;\n\n                    //enter\n                    case 13:\n                        this.onRowClick({originalEvent: event, data: rowData, index: rowIndex});\n                    break;\n\n                    default:\n                        //no op\n                    break;\n                }\n            }\n        },\n        findNextSelectableRow(row) {\n            let nextRow = row.nextElementSibling;\n            if (nextRow) {\n                if (DomHandler.hasClass(nextRow, 'p-selectable-row'))\n                    return nextRow;\n                else\n                    return this.findNextSelectableRow(nextRow);\n            }\n            else {\n                return null;\n            }\n        },\n        findPrevSelectableRow(row) {\n            let prevRow = row.previousElementSibling;\n            if (prevRow) {\n                if (DomHandler.hasClass(prevRow, 'p-selectable-row'))\n                    return prevRow;\n                else\n                    return this.findPrevSelectableRow(prevRow);\n            }\n            else {\n                return null;\n            }\n        },\n        toggleRowWithRadio(event) {\n            const rowData = event.data;\n\n            if (this.isSelected(rowData)) {\n                this.$emit('update:selection', null);\n                this.$emit('row-unselect', {originalEvent: event, data: rowData, type: 'radiobutton'});\n            }\n            else {\n                this.$emit('update:selection', rowData);\n                this.$emit('row-select', {originalEvent: event, data: rowData, type: 'radiobutton'});\n            }\n        },\n        toggleRowWithCheckbox(event) {\n            const rowData = event.data;\n\n            if (this.isSelected(rowData)) {\n                const selectionIndex = this.findIndexInSelection(rowData);\n                const _selection = this.selection.filter((val, i) => i != selectionIndex);\n                this.$emit('update:selection', _selection);\n                this.$emit('row-unselect', {originalEvent: event, data: rowData, type: 'checkbox'});\n            }\n            else {\n                let _selection = this.selection ? [...this.selection] : [];\n                _selection = [..._selection, rowData];\n                this.$emit('update:selection', _selection);\n                this.$emit('row-select', {originalEvent: event, data: rowData, type: 'checkbox'});\n            }\n        },\n        toggleRowsWithCheckbox(event) {\n            const processedData = this.processedData;\n            const checked = this.allRowsSelected;\n            const _selection = checked ? [] : (processedData ? [...processedData] : [...this.value]);\n            this.$emit('update:selection', _selection);\n\n            if (checked)\n                this.$emit('row-unselect-all', {originalEvent: event});\n            else\n                this.$emit('row-select-all', {originalEvent: event, data: _selection});\n        },\n        isSingleSelectionMode() {\n            return this.selectionMode === 'single';\n        },\n        isMultipleSelectionMode() {\n            return this.selectionMode === 'multiple';\n        },\n        isSelected(rowData) {\n            if (rowData && this.selection) {\n                if (this.dataKey) {\n                    return this.d_selectionKeys ? this.d_selectionKeys[ObjectUtils.resolveFieldData(rowData, this.dataKey)] !== undefined : false;\n                }\n                else {\n                    if (this.selection instanceof Array)\n                        return this.findIndexInSelection(rowData) > -1;\n                    else\n                        return this.equals(rowData, this.selection);\n                }\n            }\n\n            return false;\n        },\n        findIndexInSelection(rowData) {\n            return this.findIndex(rowData, this.selection);\n        },\n        findIndex(rowData, collection) {\n            let index = -1;\n            if (collection && collection.length) {\n                for (let i = 0; i < collection.length; i++) {\n                    if (this.equals(rowData, collection[i])) {\n                        index = i;\n                        break;\n                    }\n                }\n            }\n\n            return index;\n        },\n        updateSelectionKeys(selection) {\n            this.d_selectionKeys = {};\n            if (Array.isArray(selection)) {\n                for (let data of selection) {\n                    this.d_selectionKeys[String(ObjectUtils.resolveFieldData(data, this.dataKey))] = 1;\n                }\n            }\n            else {\n                this.d_selectionKeys[String(ObjectUtils.resolveFieldData(selection, this.dataKey))] = 1;\n            }\n        },\n        updateExpandedRowKeys(expandedRows) {\n            if (expandedRows && expandedRows.length) {\n                this.d_expandedRowKeys = {};\n                for (let data of expandedRows) {\n                    this.d_expandedRowKeys[String(ObjectUtils.resolveFieldData(data, this.dataKey))] = 1;\n                }\n            }\n            else {\n                this.d_expandedRowKeys = null;\n            }\n        },\n        updateEditingRowKeys(editingRows) {\n            if (editingRows && editingRows.length) {\n                this.d_editingRowKeys = {};\n                for (let data of editingRows) {\n                    this.d_editingRowKeys[String(ObjectUtils.resolveFieldData(data, this.dataKey))] = 1;\n                }\n            }\n            else {\n                this.d_editingRowKeys = null;\n            }\n        },\n        equals(data1, data2) {\n            return this.compareSelectionBy === 'equals' ? (data1 === data2) : ObjectUtils.equals(data1, data2, this.dataKey);\n        },\n        selectRange(event) {\n            let rangeStart, rangeEnd;\n\n            if (this.rangeRowIndex > this.anchorRowIndex) {\n                rangeStart = this.anchorRowIndex;\n                rangeEnd = this.rangeRowIndex;\n            }\n            else if(this.rangeRowIndex < this.anchorRowIndex) {\n                rangeStart = this.rangeRowIndex;\n                rangeEnd = this.anchorRowIndex;\n            }\n            else {\n                rangeStart = this.rangeRowIndex;\n                rangeEnd = this.rangeRowIndex;\n            }\n\n            if (this.lazy && this.paginator) {\n                rangeStart -= this.first;\n                rangeEnd -= this.first;\n            }\n\n            const value = this.processedData;\n            let _selection = [];\n            for(let i = rangeStart; i <= rangeEnd; i++) {\n                let rangeRowData = value[i];\n                _selection.push(rangeRowData);\n                this.$emit('row-select', {originalEvent: event, data: rangeRowData, type: 'row'});\n            }\n\n            this.$emit('update:selection', _selection);\n        },\n        exportCSV(options) {\n            let data = this.processedData;\n            let csv = '\\ufeff';\n\n            if (options && options.selectionOnly) {\n                data = this.selection || [];\n            }\n\n            //headers\n            for (let i = 0; i < this.columns.length; i++) {\n                let column = this.columns[i];\n                if (column.exportable !== false && column.field) {\n                    csv += '\"' + (column.header || column.field) + '\"';\n\n                    if (i < (this.columns.length - 1)) {\n                        csv += this.csvSeparator;\n                    }\n                }\n            }\n\n            //body\n            if (data) {\n                data.forEach(record => {\n                    csv += '\\n';\n                    for (let i = 0; i < this.columns.length; i++) {\n                        let column = this.columns[i];\n                        if (column.exportable !== false && column.field) {\n                            let cellData = ObjectUtils.resolveFieldData(record, column.field);\n\n                            if (cellData != null) {\n                                if (this.exportFunction) {\n                                    cellData = this.exportFunction({\n                                        data: cellData,\n                                        field: column.field\n                                    });\n                                }\n                                else\n                                    cellData = String(cellData).replace(/\"/g, '\"\"');\n                            }\n                            else\n                                cellData = '';\n\n\n                            csv += '\"' + cellData + '\"';\n\n                            if (i < (this.columns.length - 1)) {\n                                csv += this.csvSeparator;\n                            }\n                        }\n                    }\n                });\n            }\n\n            let blob = new Blob([csv], {\n                type: 'text/csv;charset=utf-8;'\n            });\n\n            if (window.navigator.msSaveOrOpenBlob) {\n                navigator.msSaveOrOpenBlob(blob, this.exportFilename + '.csv');\n            }\n            else {\n                let link = document.createElement(\"a\");\n                link.style.display = 'none';\n                document.body.appendChild(link);\n                if (link.download !== undefined) {\n                    link.setAttribute('href', URL.createObjectURL(blob));\n                    link.setAttribute('download', this.exportFilename + '.csv');\n                    link.click();\n                }\n                else {\n                    csv = 'data:text/csv;charset=utf-8,' + csv;\n                    window.open(encodeURI(csv));\n                }\n                document.body.removeChild(link);\n            }\n        },\n        resetPage() {\n            this.d_first = 0;\n            this.$emit('update:first', this.d_first);\n        },\n        onColumnResizeStart(event) {\n            let containerLeft = DomHandler.getOffset(this.$el).left;\n            this.resizeColumnElement = event.target.parentElement;\n            this.columnResizing = true;\n            this.lastResizeHelperX = (event.pageX - containerLeft + this.$el.scrollLeft);\n\n            this.bindColumnResizeEvents();\n        },\n        onColumnResize(event) {\n            let containerLeft = DomHandler.getOffset(this.$el).left;\n            DomHandler.addClass(this.$el, 'p-unselectable-text');\n            this.$refs.resizeHelper.style.height = this.$el.offsetHeight + 'px';\n            this.$refs.resizeHelper.style.top = 0 + 'px';\n            this.$refs.resizeHelper.style.left = (event.pageX - containerLeft + this.$el.scrollLeft) + 'px';\n\n            this.$refs.resizeHelper.style.display = 'block';\n        },\n        onColumnResizeEnd() {\n            let delta = this.$refs.resizeHelper.offsetLeft - this.lastResizeHelperX;\n            let columnWidth = this.resizeColumnElement.offsetWidth;\n            let newColumnWidth = columnWidth + delta;\n            let minWidth = this.resizeColumnElement.style.minWidth||15;\n\n            if (columnWidth + delta > parseInt(minWidth, 10)) {\n                if (this.columnResizeMode === 'fit') {\n                    let nextColumn = this.resizeColumnElement.nextElementSibling;\n                    let nextColumnWidth = nextColumn.offsetWidth - delta;\n\n                    if (newColumnWidth > 15 && nextColumnWidth > 15) {\n                        if(this.scrollable) {\n                            const scrollableView = this.findParentScrollableView(this.resizeColumnElement);\n                            const scrollableBodyTable = DomHandler.findSingle(scrollableView, 'table.p-datatable-scrollable-body-table');\n                            const scrollableHeaderTable = DomHandler.findSingle(scrollableView, 'table.p-datatable-scrollable-header-table');\n                            const scrollableFooterTable = DomHandler.findSingle(scrollableView, 'table.p-datatable-scrollable-footer-table');\n                            const resizeColumnIndex = DomHandler.index(this.resizeColumnElement);\n\n                            this.resizeColGroup(scrollableHeaderTable, resizeColumnIndex, newColumnWidth, nextColumnWidth);\n                            this.resizeColGroup(scrollableBodyTable, resizeColumnIndex, newColumnWidth, nextColumnWidth);\n                            this.resizeColGroup(scrollableFooterTable, resizeColumnIndex, newColumnWidth, nextColumnWidth);\n                        }\n                        else {\n                            this.resizeColumnElement.style.width = newColumnWidth + 'px';\n                            if(nextColumn) {\n                                nextColumn.style.width = nextColumnWidth + 'px';\n                            }\n                        }\n                    }\n                }\n                else if (this.columnResizeMode === 'expand') {\n                    if (this.scrollable) {\n                        this.resizeScrollableTable(this.resizeColumnElement, newColumnWidth, delta);\n                    }\n                    else {\n                        this.$refs.table.style.width = this.$refs.table.offsetWidth + delta + 'px';\n                        this.resizeColumnElement.style.width = newColumnWidth + 'px';\n                    }\n                }\n\n                this.$emit('column-resize-end', {\n                    element: this.resizeColumnElement,\n                    delta: delta\n                });\n            }\n\n            this.$refs.resizeHelper.style.display = 'none';\n            this.resizeColumn = null;\n            DomHandler.removeClass(this.$el, 'p-unselectable-text');\n\n            this.unbindColumnResizeEvents();\n\n            if (this.isStateful()) {\n                this.saveState();\n            }\n        },\n        resizeColGroup(table, resizeColumnIndex, newColumnWidth, nextColumnWidth) {\n            if(table) {\n                let colGroup = table.children[0].nodeName === 'COLGROUP' ? table.children[0] : null;\n\n                if(colGroup) {\n                    let col = colGroup.children[resizeColumnIndex];\n                    let nextCol = col.nextElementSibling;\n                    col.style.width = newColumnWidth + 'px';\n\n                    if (nextCol && nextColumnWidth) {\n                        nextCol.style.width = nextColumnWidth + 'px';\n                    }\n                }\n                else {\n                    throw new Error(\"Scrollable tables require a colgroup to support resizable columns\");\n                }\n            }\n        },\n        bindColumnResizeEvents() {\n            if (!this.documentColumnResizeListener) {\n                this.documentColumnResizeListener = document.addEventListener('mousemove', () => {\n                    if(this.columnResizing) {\n                        this.onColumnResize(event);\n                    }\n                });\n            }\n\n            if (!this.documentColumnResizeEndListener) {\n                this.documentColumnResizeEndListener = document.addEventListener('mouseup', () => {\n                    if(this.columnResizing) {\n                        this.columnResizing = false;\n                        this.onColumnResizeEnd();\n                    }\n                });\n            }\n\n        },\n        unbindColumnResizeEvents() {\n            if (this.documentColumnResizeListener) {\n                document.removeEventListener('document', this.documentColumnResizeListener);\n                this.documentColumnResizeListener = null;\n            }\n\n            if (this.documentColumnResizeEndListener) {\n                document.removeEventListener('document', this.documentColumnResizeEndListener);\n                 this.documentColumnResizeEndListener = null;\n            }\n        },\n        onColumnHeaderMouseDown(e) {\n            const event = e.originalEvent;\n            const column = e.column;\n\n            if (this.reorderableColumns && column.reorderableColumn) {\n                if (event.target.nodeName === 'INPUT' || event.target.nodeName === 'TEXTAREA' || DomHandler.hasClass(event.target, 'p-column-resizer'))\n                    event.currentTarget.draggable = false;\n                else\n                    event.currentTarget.draggable = true;\n            }\n        },\n        onColumnHeaderDragStart(event) {\n            if (this.columnResizing) {\n                event.preventDefault();\n                return;\n            }\n\n            this.colReorderIconWidth = DomHandler.getHiddenElementOuterWidth(this.$refs.reorderIndicatorUp);\n            this.colReorderIconHeight = DomHandler.getHiddenElementOuterHeight(this.$refs.reorderIndicatorUp);\n\n            this.draggedColumn = this.findParentHeader(event.target);\n            event.dataTransfer.setData('text', 'b'); // Firefox requires this to make dragging possible\n        },\n        onColumnHeaderDragOver(event) {\n            let dropHeader = this.findParentHeader(event.target);\n            if(this.reorderableColumns && this.draggedColumn && dropHeader) {\n                event.preventDefault();\n                let containerOffset = DomHandler.getOffset(this.$el);\n                let dropHeaderOffset = DomHandler.getOffset(dropHeader);\n\n                if (this.draggedColumn !== dropHeader) {\n                    let targetLeft =  dropHeaderOffset.left - containerOffset.left;\n                    let columnCenter = dropHeaderOffset.left + dropHeader.offsetWidth / 2;\n\n                    this.$refs.reorderIndicatorUp.style.top = dropHeaderOffset.top - containerOffset.top - (this.colReorderIconHeight - 1) + 'px';\n                    this.$refs.reorderIndicatorDown.style.top = dropHeaderOffset.top - containerOffset.top + dropHeader.offsetHeight + 'px';\n\n                    if(event.pageX > columnCenter) {\n                        this.$refs.reorderIndicatorUp.style.left = (targetLeft + dropHeader.offsetWidth - Math.ceil(this.colReorderIconWidth / 2)) + 'px';\n                        this.$refs.reorderIndicatorDown.style.left = (targetLeft + dropHeader.offsetWidth - Math.ceil(this.colReorderIconWidth / 2))+ 'px';\n                        this.dropPosition = 1;\n                    }\n                    else {\n                        this.$refs.reorderIndicatorUp.style.left = (targetLeft - Math.ceil(this.colReorderIconWidth / 2)) + 'px';\n                        this.$refs.reorderIndicatorDown.style.left = (targetLeft - Math.ceil(this.colReorderIconWidth / 2))+ 'px';\n                        this.dropPosition = -1;\n                    }\n\n                    this.$refs.reorderIndicatorUp.style.display = 'block';\n                    this.$refs.reorderIndicatorDown.style.display = 'block';\n                }\n            }\n        },\n        onColumnHeaderDragLeave(event) {\n            if(this.reorderableColumns && this.draggedColumn) {\n                event.preventDefault();\n                this.$refs.reorderIndicatorUp.style.display = 'none';\n                this.$refs.reorderIndicatorDown.style.display = 'none';\n            }\n        },\n        onColumnHeaderDrop(event) {\n            event.preventDefault();\n            if (this.draggedColumn) {\n                let dragIndex = DomHandler.index(this.draggedColumn);\n                let dropIndex = DomHandler.index(this.findParentHeader(event.target));\n                let allowDrop = (dragIndex !== dropIndex);\n                if (allowDrop && ((dropIndex - dragIndex === 1 && this.dropPosition === -1) || (dragIndex - dropIndex === 1 && this.dropPosition === 1))) {\n                    allowDrop = false;\n                }\n\n                if (allowDrop) {\n                    ObjectUtils.reorderArray(this.d_columnOrder, dragIndex, dropIndex);\n\n                    this.$emit('column-reorder', {\n                        originalEvent: event,\n                        dragIndex: dragIndex,\n                        dropIndex: dropIndex\n                    });\n                }\n\n                this.$refs.reorderIndicatorUp.style.display = 'none';\n                this.$refs.reorderIndicatorDown.style.display = 'none';\n                this.draggedColumn.draggable = false;\n                this.draggedColumn = null;\n                this.dropPosition = null;\n            }\n        },\n        findParentHeader(element) {\n            if(element.nodeName === 'TH') {\n                return element;\n            }\n            else {\n                let parent = element.parentElement;\n                while(parent.nodeName !== 'TH') {\n                    parent = parent.parentElement;\n                    if (!parent) break;\n                }\n                return parent;\n            }\n        },\n        findParentScrollableView(column) {\n            if (column) {\n                let parent = column.parentElement;\n                while (parent && !DomHandler.hasClass(parent, 'p-datatable-scrollable-view')) {\n                    parent = parent.parentElement;\n                }\n\n                return parent;\n            }\n            else {\n                return null;\n            }\n        },\n        findColumnByKey(columns, key) {\n            if(columns && columns.length) {\n                for(let i = 0; i < columns.length; i++) {\n                    let child = columns[i];\n                    if(child.columnKey === key || child.field === key) {\n                        return child;\n                    }\n                }\n            }\n\n            return null;\n        },\n        resizeScrollableTable(column, newColumnWidth, delta) {\n            const scrollableView = column ? this.findParentScrollableView(column) : this.$el;\n            const scrollableBody = DomHandler.findSingle(scrollableView, '.p-datatable-scrollable-body');\n            const scrollableHeader = DomHandler.findSingle(scrollableView, '.p-datatable-scrollable-header');\n            const scrollableFooter = DomHandler.findSingle(scrollableView, '.p-datatable-scrollable-footer');\n            const scrollableBodyTable = DomHandler.findSingle(scrollableBody, 'table.p-datatable-scrollable-body-table');\n            const scrollableHeaderTable = DomHandler.findSingle(scrollableHeader, 'table.p-datatable-scrollable-header-table');\n            const scrollableFooterTable = DomHandler.findSingle(scrollableFooter, 'table.p-datatable-scrollable-footer-table');\n\n            const scrollableBodyTableWidth = column ? scrollableBodyTable.offsetWidth + delta : newColumnWidth;\n            const scrollableHeaderTableWidth = column ? scrollableHeaderTable.offsetWidth + delta : newColumnWidth;\n            const isContainerInViewport = this.$el.offsetWidth >= parseFloat(scrollableBodyTableWidth);\n\n            let setWidth = (container, table, width, isContainerInViewport) => {\n                if (container && table) {\n                    container.style.width = isContainerInViewport ? width + DomHandler.calculateScrollbarWidth(scrollableBody) + 'px' : 'auto'\n                    table.style.width = width + 'px';\n                }\n            };\n\n            setWidth(scrollableBody, scrollableBodyTable, scrollableBodyTableWidth, isContainerInViewport);\n            setWidth(scrollableHeader, scrollableHeaderTable, scrollableHeaderTableWidth, isContainerInViewport);\n            setWidth(scrollableFooter, scrollableFooterTable, scrollableHeaderTableWidth, isContainerInViewport);\n\n            if (column) {\n                let resizeColumnIndex = DomHandler.index(column);\n\n                this.resizeColGroup(scrollableHeaderTable, resizeColumnIndex, newColumnWidth, null);\n                this.resizeColGroup(scrollableBodyTable, resizeColumnIndex, newColumnWidth, null);\n                this.resizeColGroup(scrollableFooterTable, resizeColumnIndex, newColumnWidth, null);\n            }\n        },\n        onRowMouseDown(event) {\n            if (DomHandler.hasClass(event.target, 'p-datatable-reorderablerow-handle'))\n                event.currentTarget.draggable = true;\n            else\n                event.currentTarget.draggable = false;\n        },\n        onRowDragStart(e) {\n            const event = e.originalEvent;\n            const index = e.index;\n            this.rowDragging = true;\n            this.draggedRowIndex = index;\n            event.dataTransfer.setData('text', 'b');    // For firefox\n        },\n        onRowDragOver(e) {\n            const event = e.originalEvent;\n            const index = e.index;\n\n            if (this.rowDragging && this.draggedRowIndex !== index) {\n                let rowElement = event.currentTarget;\n                let rowY = DomHandler.getOffset(rowElement).top + DomHandler.getWindowScrollTop();\n                let pageY = event.pageY;\n                let rowMidY = rowY + DomHandler.getOuterHeight(rowElement) / 2;\n                let prevRowElement = rowElement.previousElementSibling;\n\n                if (pageY < rowMidY) {\n                    DomHandler.removeClass(rowElement, 'p-datatable-dragpoint-bottom');\n\n                    this.droppedRowIndex = index;\n                    if (prevRowElement)\n                        DomHandler.addClass(prevRowElement, 'p-datatable-dragpoint-bottom');\n                    else\n                        DomHandler.addClass(rowElement, 'p-datatable-dragpoint-top');\n                }\n                else {\n                    if (prevRowElement)\n                        DomHandler.removeClass(prevRowElement, 'p-datatable-dragpoint-bottom');\n                    else\n                        DomHandler.addClass(rowElement, 'p-datatable-dragpoint-top');\n\n                    this.droppedRowIndex = index + 1;\n                    DomHandler.addClass(rowElement, 'p-datatable-dragpoint-bottom');\n                }\n\n                event.preventDefault();\n            }\n        },\n        onRowDragLeave(event) {\n            let rowElement = event.currentTarget;\n            let prevRowElement = rowElement.previousElementSibling;\n            if (prevRowElement) {\n                DomHandler.removeClass(prevRowElement, 'p-datatable-dragpoint-bottom');\n            }\n\n            DomHandler.removeClass(rowElement, 'p-datatable-dragpoint-bottom');\n            DomHandler.removeClass(rowElement, 'p-datatable-dragpoint-top');\n        },\n        onRowDragEnd(event) {\n            this.rowDragging = false;\n            this.draggedRowIndex = null;\n            this.droppedRowIndex = null;\n            event.currentTarget.draggable = false;\n        },\n        onRowDrop(event) {\n            if (this.droppedRowIndex != null) {\n                let dropIndex = (this.draggedRowIndex > this.droppedRowIndex) ? this.droppedRowIndex : (this.droppedRowIndex === 0) ? 0 : this.droppedRowIndex - 1;\n                let processedData = [...this.processedData];\n                ObjectUtils.reorderArray(processedData, this.draggedRowIndex, dropIndex);\n\n                this.$emit('row-reorder', {\n                    originalEvent: event,\n                    dragIndex: this.draggedRowIndex,\n                    dropIndex: dropIndex,\n                    value: processedData\n                });\n            }\n\n            //cleanup\n            this.onRowDragLeave(event);\n            this.onRowDragEnd(event);\n            event.preventDefault();\n        },\n        toggleRow(event) {\n            let rowData = event.data;\n            let expanded;\n            let expandedRowIndex;\n            let _expandedRows = this.expandedRows ? [...this.expandedRows] : [];\n\n            if (this.dataKey) {\n                expanded = this.d_expandedRowKeys ? this.d_expandedRowKeys[ObjectUtils.resolveFieldData(rowData, this.dataKey)] !== undefined : false;\n            }\n            else {\n                expandedRowIndex = this.findIndex(rowData, this.expandedRows);\n                expanded = expandedRowIndex > -1;\n            }\n\n            if (expanded) {\n                if (expandedRowIndex == null) {\n                    expandedRowIndex = this.findIndex(rowData, this.expandedRows);\n                }\n                _expandedRows.splice(expandedRowIndex, 1);\n                this.$emit('update:expandedRows', _expandedRows);\n                this.$emit('row-collapse', event);\n            }\n            else {\n                _expandedRows.push(rowData);\n                this.$emit('update:expandedRows', _expandedRows);\n                this.$emit('row-expand', event);\n            }\n        },\n        toggleRowGroup(e) {\n            const event = e.originalEvent;\n            const data = e.data;\n            const groupFieldValue = ObjectUtils.resolveFieldData(data, this.groupRowsBy);\n            let _expandedRowGroups = this.expandedRowGroups ? [...this.expandedRowGroups] : [];\n\n            if (this.isRowGroupExpanded(data)) {\n                _expandedRowGroups = _expandedRowGroups.filter(group => group !== groupFieldValue);\n                this.$emit('update:expandedRowGroups', _expandedRowGroups);\n                this.$emit('rowgroup-collapse', {originalEvent: event, data: groupFieldValue});\n            }\n            else {\n                _expandedRowGroups.push(groupFieldValue);\n                this.$emit('update:expandedRowGroups', _expandedRowGroups);\n                this.$emit('rowgroup-expand', {originalEvent: event, data: groupFieldValue});\n            }\n        },\n        isRowGroupExpanded(rowData) {\n            if (this.expandableRowGroups && this.expandedRowGroups) {\n                let groupFieldValue = ObjectUtils.resolveFieldData(rowData, this.groupRowsBy);\n                return this.expandedRowGroups.indexOf(groupFieldValue) > -1;\n            }\n            return false;\n        },\n        isStateful() {\n            return this.stateKey != null;\n        },\n        getStorage() {\n            switch(this.stateStorage) {\n                case 'local':\n                    return window.localStorage;\n\n                case 'session':\n                    return window.sessionStorage;\n\n                default:\n                    throw new Error(this.stateStorage + ' is not a valid value for the state storage, supported values are \"local\" and \"session\".');\n            }\n        },\n        saveState() {\n            const storage = this.getStorage();\n            let state = {};\n\n            if (this.paginator) {\n                state.first = this.d_first;\n                state.rows = this.d_rows;\n            }\n\n            if (this.d_sortField) {\n                state.sortField = this.d_sortField;\n                state.sortOrder = this.d_sortOrder;\n            }\n\n            if (this.d_multiSortMeta) {\n                state.multiSortMeta = this.d_multiSortMeta;\n            }\n\n            if (this.hasFilters()) {\n                state.filters = this.filters;\n            }\n\n            if (this.resizableColumns) {\n                this.saveColumnWidths(state);\n            }\n\n            if (this.reorderableColumns) {\n                state.columnOrder = this.d_columnOrder;\n            }\n\n            if (this.expandedRows) {\n                state.expandedRows = this.expandedRows;\n                state.expandedRowKeys = this.d_expandedRowKeys;\n            }\n\n            if (this.expandedRowGroups) {\n                state.expandedRowGroups = this.expandedRowGroups;\n            }\n\n            if (this.selection) {\n                state.selection = this.selection;\n                state.selectionKeys = this.d_selectionKeys;\n            }\n\n            if (Object.keys(state).length) {\n                storage.setItem(this.stateKey, JSON.stringify(state));\n            }\n\n            this.$emit('state-save', state);\n        },\n        restoreState() {\n            const storage = this.getStorage();\n            const stateString = storage.getItem(this.stateKey);\n\n            if (stateString) {\n                let restoredState = JSON.parse(stateString);\n\n                if (this.paginator) {\n                    this.d_first = restoredState.first;\n                    this.d_rows = restoredState.rows;\n                }\n\n                if (restoredState.sortField) {\n                    this.d_sortField = restoredState.sortField;\n                    this.d_sortOrder = restoredState.sortOrder;\n                }\n\n                if (restoredState.multiSortMeta) {\n                    this.d_multiSortMeta = restoredState.multiSortMeta;\n                }\n\n                if (restoredState.filters) {\n                    this.$emit('update:filters', restoredState.filters);\n                }\n\n                if (this.resizableColumns) {\n                    this.columnWidthsState = restoredState.columnWidths;\n                    this.tableWidthState = restoredState.tableWidth;\n                }\n\n                if (this.reorderableColumns) {\n                    this.d_columnOrder = restoredState.columnOrder;\n                }\n\n                if (restoredState.expandedRows) {\n                    this.d_expandedRowKeys = restoredState.expandedRowKeys;\n                    this.$emit('update:expandedRows', restoredState.expandedRows);\n                }\n\n                if (restoredState.expandedRowGroups) {\n                    this.$emit('update:expandedRowGroups', restoredState.expandedRowGroups);\n                }\n\n                if (restoredState.selection) {\n                    this.d_selectionKeys = restoredState.d_selectionKeys;\n                    this.$emit('update:selection', restoredState.selection);\n                }\n\n                this.$emit('state-restore', restoredState);\n            }\n        },\n        saveColumnWidths(state) {\n            let widths = [];\n            let headers = DomHandler.find(this.$el, '.p-datatable-thead > tr > th');\n            headers.forEach(header => widths.push(DomHandler.getOuterWidth(header)));\n            state.columnWidths = widths.join(',');\n\n            if (this.columnResizeMode === 'expand') {\n                state.tableWidth = this.scrollable ? DomHandler.findSingle(this.$el, '.p-datatable-scrollable-header-table').style.width :\n                                                    DomHandler.getOuterWidth(this.$refs.table) + 'px';\n            }\n        },\n        restoreColumnWidths() {\n            if (this.columnWidthsState) {\n                let widths = this.columnWidthsState.split(',');\n\n                if (this.columnResizeMode === 'expand' && this.tableWidthState) {\n                    if (this.scrollable) {\n                        this.resizeScrollableTable(null, this.tableWidthState, 0);\n                    }\n                    else {\n                        this.$refs.table.style.width = this.tableWidthState;\n                        this.$el.style.width = this.tableWidthState;\n                    }\n                }\n\n                if (this.scrollable) {\n                    let headerCols = DomHandler.find(this.$el, '.p-datatable-scrollable-header-table > colgroup > col');\n                    let bodyCols = DomHandler.find(this.$el, '.p-datatable-scrollable-body-table > colgroup > col');\n\n                    headerCols.forEach((col, index) => col.style.width = widths[index] + 'px');\n                    bodyCols.forEach((col, index) => col.style.width = widths[index] + 'px');\n                }\n                else {\n                    let headers = DomHandler.find(this.$refs.table, '.p-datatable-thead > tr > th');\n                    headers.forEach((header, index) => header.style.width = widths[index] + 'px');\n                }\n\n\n            }\n        },\n        onCellEditInit(event) {\n            this.$emit('cell-edit-init', event);\n        },\n        onCellEditComplete(event) {\n            this.$emit('cell-edit-complete', event);\n        },\n        onCellEditCancel(event) {\n            this.$emit('cell-edit-cancel', event);\n        },\n        onRowEditInit(event) {\n            let _editingRows = this.editingRows ? [...this.editingRows] : [];\n            _editingRows.push(event.data);\n            this.$emit('update:editingRows', _editingRows);\n            this.$emit('row-edit-init', event);\n        },\n        onRowEditSave(event) {\n            let _editingRows = [...this.editingRows];\n            _editingRows.splice(this.findIndex(event.data, _editingRows), 1);\n            this.$emit('update:editingRows', _editingRows);\n            this.$emit('row-edit-save', event);\n        },\n        onRowEditCancel(event) {\n            let _editingRows = [...this.editingRows];\n            _editingRows.splice(this.findIndex(event.data, _editingRows), 1);\n            this.$emit('update:editingRows', _editingRows);\n            this.$emit('row-edit-cancel', event);\n        },\n        onVirtualScroll(event) {\n            if(this.virtualScrollTimer) {\n                clearTimeout(this.virtualScrollTimer);\n            }\n\n            this.virtualScrollTimer = setTimeout(() => {\n                this.$emit('virtual-scroll', {\n                        first: (event.page - 1) * this.rows,\n                        rows: this.rows * 2\n                    });\n                }, this.virtualScrollDelay);\n        },\n        createLazyLoadEvent(event) {\n            let filterMatchModes;\n            if (this.hasFilters()) {\n                filterMatchModes = {};\n                this.columns.forEach(col => {\n                    if (col.field) {\n                        filterMatchModes[col.field] = col.filterMatchMode;\n                    }\n                });\n            }\n\n            return {\n                originalEvent: event,\n                first: this.d_first,\n                rows: this.d_rows,\n                sortField: this.d_sortField,\n                sortOrder: this.d_sortOrder,\n                multiSortMeta: this.d_multiSortMeta,\n                filters: this.filters,\n                filterMatchModes: filterMatchModes\n            };\n        },\n        hasFilters() {\n            return this.filters && Object.keys(this.filters).length > 0 && this.filters.constructor === Object;\n        },\n        hasGlobalFilter() {\n            return this.filters && Object.prototype.hasOwnProperty.call(this.filters, 'global');\n        },\n    },\n    computed: {\n        containerClass() {\n            return [\n                'p-datatable p-component', {\n                    'p-datatable-hoverable-rows': (this.rowHover || this.selectionMode),\n                    'p-datatable-auto-layout': this.autoLayout,\n                    'p-datatable-resizable': this.resizableColumns,\n                    'p-datatable-resizable-fit': this.resizableColumns && this.columnResizeMode === 'fit',\n                    'p-datatable-scrollable': this.scrollable,\n                    'p-datatable-virtual-scrollable': this.virtualScroll,\n                    'p-datatable-flex-scrollable': (this.scrollable && this.scrollHeight === 'flex')\n                }\n            ];\n        },\n        columns() {\n            let columns = [];\n\n            if (this.allChildren) {\n                columns = this.allChildren.filter(child => child.$options._propKeys.indexOf('columnKey') !== -1);\n\n                if (this.reorderableColumns && this.d_columnOrder) {\n                    let orderedColumns = [];\n                    for (let columnKey of this.d_columnOrder) {\n                        let column = this.findColumnByKey(columns, columnKey);\n                        if (column) {\n                            orderedColumns.push(column);\n                        }\n                    }\n\n                    return [...orderedColumns, ...columns.filter((item) => {\n                        return orderedColumns.indexOf(item) < 0;\n                    })];\n                }\n            }\n            return columns;\n        },\n        frozenColumns() {\n            let frozenColumns = [];\n\n            for(let col of this.columns) {\n                if(col.frozen) {\n                    frozenColumns = frozenColumns||[];\n                    frozenColumns.push(col);\n                }\n            }\n\n            return frozenColumns;\n        },\n        scrollableColumns() {\n            let scrollableColumns = [];\n\n            for(let col of this.columns) {\n                if(!col.frozen) {\n                    scrollableColumns = scrollableColumns||[];\n                    scrollableColumns.push(col);\n                }\n            }\n\n            return scrollableColumns;\n        },\n        hasFrozenColumns() {\n            return this.frozenColumns.length > 0;\n        },\n        headerColumnGroup() {\n            if (this.allChildren) {\n                for (let child of this.allChildren) {\n                    if (child.$vnode.tag.indexOf('columngroup') !== -1 && child.type === 'header') {\n                        return child;\n                    }\n                }\n            }\n\n            return null;\n        },\n        frozenHeaderColumnGroup() {\n            if (this.allChildren) {\n                for (let child of this.allChildren) {\n                    if (child.$vnode.tag.indexOf('columngroup') !== -1 && child.type === 'frozenheader') {\n                        return child;\n                    }\n                }\n            }\n\n            return null;\n        },\n        footerColumnGroup() {\n            if (this.allChildren) {\n                for (let child of this.allChildren) {\n                    if (child.$vnode.tag.indexOf('columngroup') !== -1 && child.type === 'footer') {\n                        return child;\n                    }\n                }\n            }\n\n            return null;\n        },\n        frozenFooterColumnGroup() {\n            if (this.allChildren) {\n                for (let child of this.allChildren) {\n                    if (child.$vnode.tag.indexOf('columngroup') !== -1 && child.type === 'frozenfooter') {\n                        return child;\n                    }\n                }\n            }\n\n            return null;\n        },\n        processedData() {\n            if (this.lazy) {\n                return this.value;\n            }\n            else {\n                if (this.value && this.value.length) {\n                    let data = this.value;\n\n                    if (this.sorted) {\n                        if(this.sortMode === 'single')\n                            data = this.sortSingle(data);\n                        else if(this.sortMode === 'multiple')\n                            data = this.sortMultiple(data);\n                    }\n\n                    if (this.hasFilters()) {\n                        data = this.filter(data);\n                    }\n\n                    return data;\n                }\n                else {\n                    return null;\n                }\n            }\n        },\n        dataToRender() {\n            const data = this.processedData;\n\n            if (data && this.paginator) {\n                const first = this.lazy ? 0 : this.d_first;\n                return data.slice(first, first + this.d_rows);\n            }\n            else {\n                return data;\n            }\n        },\n        totalRecordsLength() {\n            if (this.lazy) {\n                return this.totalRecords;\n            }\n            else {\n                const data = this.processedData;\n                return data ? data.length : 0;\n            }\n        },\n        empty() {\n            const data = this.processedData;\n            return (!data || data.length === 0);\n        },\n        paginatorTop() {\n            return this.paginator && (this.paginatorPosition !== 'bottom' || this.paginatorPosition === 'both');\n        },\n        paginatorBottom() {\n            return this.paginator && (this.paginatorPosition !== 'top' || this.paginatorPosition === 'both');\n        },\n        sorted() {\n            return this.d_sortField || (this.d_multiSortMeta && this.d_multiSortMeta.length > 0);\n        },\n        loadingIconClass() {\n            return ['p-datatable-loading-icon pi-spin', this.loadingIcon];\n        },\n        allRowsSelected() {\n            const val = this.processedData;\n            return (val && val.length > 0 && this.selection && this.selection.length > 0 && this.selection.length === val.length);\n        }\n    },\n    components: {\n        'DTPaginator': Paginator,\n        'DTScrollableView': ScrollableView,\n        'DTTableHeader': TableHeader,\n        'DTTableBody': TableBody,\n        'DTTableFooter': TableFooter,\n    }\n}\n</script>\n\n<style>\n.p-datatable {\n    position: relative;\n}\n\n.p-datatable table {\n    border-collapse: collapse;\n    width: 100%;\n    table-layout: fixed;\n}\n\n.p-datatable .p-sortable-column {\n    cursor: pointer;\n    user-select: none;\n}\n\n.p-datatable .p-sortable-column .p-column-title,\n.p-datatable .p-sortable-column .p-sortable-column-icon,\n.p-datatable .p-sortable-column .p-sortable-column-badge {\n    vertical-align: middle;\n}\n\n.p-datatable .p-sortable-column .p-sortable-column-badge {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.p-datatable-auto-layout > .p-datatable-wrapper {\n    overflow-x: auto;\n}\n\n.p-datatable-auto-layout > .p-datatable-wrapper > table {\n    table-layout: auto;\n}\n\n.p-datatable-hoverable-rows .p-selectable-row {\n    cursor: pointer;\n}\n\n/* Scrollable */\n.p-datatable-scrollable-wrapper {\n    position: relative;\n}\n\n.p-datatable-scrollable-header,\n.p-datatable-scrollable-footer {\n    overflow: hidden;\n}\n\n.p-datatable-scrollable-body {\n    overflow: auto;\n    position: relative;\n}\n\n.p-datatable-scrollable-body > table > .p-datatable-tbody > tr:first-child > td {\n    border-top: 0 none;\n}\n\n.p-datatable-virtual-table {\n    position: absolute;\n}\n\n/* Frozen Columns */\n.p-datatable-frozen-view .p-datatable-scrollable-body {\n    overflow: hidden;\n}\n\n.p-datatable-frozen-view > .p-datatable-scrollable-body > table > .p-datatable-tbody > tr > td:last-child {\n    border-right: 0 none;\n}\n\n.p-datatable-unfrozen-view {\n    position: absolute;\n    top: 0;\n}\n\n/* Flex Scrollable */\n.p-datatable-flex-scrollable {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    height: 100%;\n}\n\n.p-datatable-flex-scrollable .p-datatable-scrollable-wrapper,\n.p-datatable-flex-scrollable .p-datatable-scrollable-view {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    height: 100%;\n}\n\n.p-datatable-flex-scrollable .p-datatable-scrollable-body {\n    flex: 1;\n}\n\n/* Resizable */\n.p-datatable-resizable > .p-datatable-wrapper {\n    overflow-x: auto;\n}\n\n.p-datatable-resizable .p-datatable-thead > tr > th,\n.p-datatable-resizable .p-datatable-tfoot > tr > td,\n.p-datatable-resizable .p-datatable-tbody > tr > td {\n    overflow: hidden;\n    white-space: nowrap;\n}\n\n.p-datatable-resizable .p-resizable-column {\n    background-clip: padding-box;\n    position: relative;\n}\n\n.p-datatable-resizable-fit .p-resizable-column:last-child .p-column-resizer {\n    display: none;\n}\n\n.p-datatable .p-column-resizer {\n    display: block;\n    position: absolute !important;\n    top: 0;\n    right: 0;\n    margin: 0;\n    width: .5rem;\n    height: 100%;\n    padding: 0px;\n    cursor:col-resize;\n    border: 1px solid transparent;\n}\n\n.p-datatable .p-column-resizer-helper {\n    width: 1px;\n    position: absolute;\n    z-index: 10;\n    display: none;\n}\n\n.p-datatable .p-row-editor-init,\n.p-datatable .p-row-editor-save,\n.p-datatable .p-row-editor-cancel {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    overflow: hidden;\n    position: relative;\n}\n\n/* Expand */\n.p-datatable .p-row-toggler {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    overflow: hidden;\n    position: relative;\n}\n\n/* Reorder */\n.p-datatable-reorder-indicator-up,\n.p-datatable-reorder-indicator-down {\n    position: absolute;\n    display: none;\n}\n\n/* Loader */\n.p-datatable .p-datatable-loading-overlay {\n    position: absolute;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 2;\n}\n</style>\n"]}]}